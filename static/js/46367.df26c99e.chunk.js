(self.webpackChunkweb=self.webpackChunkweb||[]).push([[46367],{786141:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VaultBase:()=>D,VaultBaseChainOnly:()=>O});var r=n(72579),a=n.n(r),o=n(256666),i=n(301842),d=n.n(i),c=n(634795),u=n(887371),s=n(545754),f=n(411987),l=n(695058),p=n(206391),b=n.n(p),y=n(636393),h=n(613549),v=n(292147),m=n(213208),g=n(992431),w=n(940915),T=n(278489),x=n(969618),I=n(398514),A=n(114540),E=n(348834).Buffer;function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,f.default)(this,n)}}if(m.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var O=function(e){(0,s.default)(n,e);var t=N(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=(0,c.default)((function*(){var e=(yield this.getNetwork()).impl;d()(x.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new w.NotImplemented},r.getEthersProvider=function(){var e=(0,c.default)((function*(){throw new w.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=(0,c.default)((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=(0,c.default)((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=(0,c.default)((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||!n)throw new w.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=(0,c.default)((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=(0,c.default)((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new w.InvalidTokenAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=(0,c.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=(0,c.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=(0,c.default)((function*(e,t,n){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:k({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=(0,c.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return 0}));return function(){return e.apply(this,arguments)}}(),r.isEarliestPendingTx=function(){var e=(0,c.default)((function*(e){e.encodedTx;return!0}));return function(t){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=(0,c.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=(0,c.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=(0,c.default)((function*(){var e=yield this.getNetwork();return(0,T.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=(0,c.default)((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=(0,c.default)((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=(0,c.default)((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=(0,c.default)((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=(0,c.default)((function*(){throw new w.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=(0,c.default)((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=(0,c.default)((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=(0,c.default)((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionDetail=function(){var e=(0,c.default)((function*(e){return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),(0,u.default)(n)}(A.VaultContext),D=function(e){(0,s.default)(n,e);var t=N(n);function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).uuid=y.default.v4().toString(),e}var r=n.prototype;return r.init=function(){var e=(0,c.default)((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),r.initKeyring=function(){var e=(0,c.default)((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=(0,c.default)((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),r.signAndSendTransaction=function(){var e=(0,c.default)((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?k(k({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(k(k({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(){var e=(0,c.default)((function*(e,t){v.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return v.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),k(k({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxFromBatchTransfer=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxsFromSetApproveForAll=function(){var e=(0,c.default)((function*(e,t){throw new w.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),r.activateAccount=function(){var e=(0,c.default)((function*(){throw new w.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.activateToken=function(){var e=(0,c.default)((function*(e,t){throw new w.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),r.getTokenAllowance=function(){var e=(0,c.default)((function*(e,t){throw new w.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),r.batchTokensAllowance=function(){var e=(0,c.default)((function*(e,t){throw new w.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),r.getOutputAccount=function(){var e=(0,c.default)((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:a()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),r.getAccountBalance=function(){var e=(0,c.default)((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=(yield this.getDbAccount()).address;return this.getBalances((t?[{address:a}]:[]).concat(e.map((function(e){return{address:a,tokenAddress:e}}))),n,r)}));return function(t){return e.apply(this,arguments)}}(),r.updatePendingTxs=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNonce=function(){var e=(0,c.default)((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),r.fixActionDirection=function(){var e=(0,c.default)((function*(e){var t,n,r,a,o=e.action,i=e.accountAddress;(o.direction=I.IDecodedTxDirection.OTHER,o.type===I.IDecodedTxActionType.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:i}));o.type===I.IDecodedTxActionType.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(a=o.tokenTransfer)?void 0:a.to)||"",address:i}));return o}));return function(t){return e.apply(this,arguments)}}(),r.fixDecodedTx=function(){var e=(0,c.default)((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=d()(r)?e.nonce:new(b())(r).toNumber();for(var a=e.owner,o=0;o<e.actions.length;o+=1){var i=e.actions[o];yield this.fixActionDirection({action:i,accountAddress:a})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var u=e.outputActions[c];yield this.fixActionDirection({action:u,accountAddress:a})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.fixHistoryTx=function(){var e=(0,c.default)((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.buildHistoryTx=function(){var e=(0,c.default)((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,a=e.isSigner,o=e.isLocalCreated,i=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!i)throw new Error("buildHistoryTx txid not found");var d=yield this.getAccountAddress();n.txid=i||n.txid,n.owner=d,a&&(n.signer=d),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var c=k(k({id:`${this.networkId}_${i}_${this.accountId}`,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return c=yield this.fixHistoryTx(c),Promise.resolve(c)}));return function(t){return e.apply(this,arguments)}}(),r.checkIsScamHistoryTx=function(){var e=(0,c.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.fetchOnChainHistory=function(){var e=(0,c.default)((function*(e){throw new w.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.fixAddressCase=function(e){return Promise.resolve(e)},r.buildTxActionDirection=function(){var e=(0,c.default)((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?I.IDecodedTxDirection.SELF:t&&t===r?I.IDecodedTxDirection.OUT:n&&n===r?I.IDecodedTxDirection.IN:I.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),r.getNextNonce=function(){var e=(0,c.default)((function*(e,t){var n,r=null==(n=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:n.nonce;if(d()(r))throw new w.OneKeyError("Get on-chain nonce failed.");yield this.engine.getHistory(e,t.id,void 0,!1);var a=yield g.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e}),o=yield g.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),i=Math.max(d()(a)?0:a+1,r);if(Number.isNaN(i)&&(i=r),i>r)for(var c=r;c<i;c+=1)if(!o.includes(c)){i=c;break}if(i<r&&(i=r),i-r>=h.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new w.PendingQueueTooLong(h.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return i}));return function(t,n){return e.apply(this,arguments)}}(),r.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},r.notifyChainChanged=function(e,t){},r.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},r.getPrivateKeyByCredential=function(e){return Promise.resolve(E.from(e.startsWith("0x")?e.slice(2):e,"hex"))},r.getMinDepositAmount=function(){var e=(0,c.default)((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),r.specialCheckEncodedTx=function(){var e=(0,c.default)((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),r.getAllUsedAddress=function(){var e=(0,c.default)((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),r.attachFeeInfoToDAppEncodedTx=function(){var e=(0,c.default)((function*(e){return Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),(0,u.default)(n)}(O)},946367:(e,t,n)=>{"use strict";n.r(t),n.d(t,{IDecodedTxEvmType:()=>Ge,default:()=>Ye});var r=n(817620),a=n.n(r),o=n(453982),i=n.n(o),d=n(317335),c=n.n(d),u=n(785505),s=n.n(u),f=n(459740),l=n(301842),p=n.n(l),b=n(158215),y=n.n(b),h=n(968079),v=n(256666),m=n(196234),g=n(634795),w=n(887371),T=n(163473),x=n(545754),I=n(411987),A=n(695058),E=n(299780);const P=JSON.parse('{"_format":"hh-sol-artifact-1","contractName":"ERC1155","sourceName":"contracts/token/ERC1155/ERC1155.sol","abi":[{"inputs":[{"internalType":"string","name":"uri_","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"indexed":false,"internalType":"uint256[]","name":"values","type":"uint256[]"}],"name":"TransferBatch","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"TransferSingle","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"value","type":"string"},{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"}],"name":"URI","type":"event"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"accounts","type":"address[]"},{"internalType":"uint256[]","name":"ids","type":"uint256[]"}],"name":"balanceOfBatch","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeBatchTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"uri","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],"bytecode":"0x60806040523480156200001157600080fd5b50604051620015cb380380620015cb83398101604081905262000034916200011b565b6200003f8162000046565b5062000233565b80516200005b9060029060208401906200005f565b5050565b8280546200006d90620001f7565b90600052602060002090601f016020900481019282620000915760008555620000dc565b82601f10620000ac57805160ff1916838001178555620000dc565b82800160010185558215620000dc579182015b82811115620000dc578251825591602001919060010190620000bf565b50620000ea929150620000ee565b5090565b5b80821115620000ea5760008155600101620000ef565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156200012f57600080fd5b82516001600160401b03808211156200014757600080fd5b818501915085601f8301126200015c57600080fd5b81518181111562000171576200017162000105565b604051601f8201601f19908116603f011681019083821181831017156200019c576200019c62000105565b816040528281528886848701011115620001b557600080fd5b600093505b82841015620001d95784840186015181850187015292850192620001ba565b82841115620001eb5760008684830101525b98975050505050505050565b600181811c908216806200020c57607f821691505b6020821081036200022d57634e487b7160e01b600052602260045260246000fd5b50919050565b61138880620002436000396000f3fe608060405234801561001057600080fd5b50600436106100875760003560e01c80634e1273f41161005b5780634e1273f41461010a578063a22cb4651461012a578063e985e9c51461013d578063f242432a1461017957600080fd5b8062fdd58e1461008c57806301ffc9a7146100b25780630e89341c146100d55780632eb2c2d6146100f5575b600080fd5b61009f61009a366004610b3f565b61018c565b6040519081526020015b60405180910390f35b6100c56100c0366004610b82565b610222565b60405190151581526020016100a9565b6100e86100e3366004610ba6565b610274565b6040516100a99190610c0c565b610108610103366004610d6b565b610308565b005b61011d610118366004610e15565b610354565b6040516100a99190610f1b565b610108610138366004610f2e565b61047e565b6100c561014b366004610f6a565b6001600160a01b03918216600090815260016020908152604080832093909416825291909152205460ff1690565b610108610187366004610f9d565b61048d565b60006001600160a01b0383166101fc5760405162461bcd60e51b815260206004820152602a60248201527f455243313135353a2061646472657373207a65726f206973206e6f742061207660448201526930b634b21037bbb732b960b11b60648201526084015b60405180910390fd5b506000908152602081815260408083206001600160a01b03949094168352929052205490565b60006001600160e01b03198216636cdb3d1360e11b148061025357506001600160e01b031982166303a24d0760e21b145b8061026e57506301ffc9a760e01b6001600160e01b03198316145b92915050565b60606002805461028390611002565b80601f01602080910402602001604051908101604052809291908181526020018280546102af90611002565b80156102fc5780601f106102d1576101008083540402835291602001916102fc565b820191906000526020600020905b8154815290600101906020018083116102df57829003601f168201915b50505050509050919050565b6001600160a01b0385163314806103245750610324853361014b565b6103405760405162461bcd60e51b81526004016101f39061103c565b61034d85858585856104d2565b5050505050565b606081518351146103b95760405162461bcd60e51b815260206004820152602960248201527f455243313135353a206163636f756e747320616e6420696473206c656e677468604482015268040dad2e6dac2e8c6d60bb1b60648201526084016101f3565b6000835167ffffffffffffffff8111156103d5576103d5610c1f565b6040519080825280602002602001820160405280156103fe578160200160208202803683370190505b50905060005b8451811015610476576104498582815181106104225761042261108a565b602002602001015185838151811061043c5761043c61108a565b602002602001015161018c565b82828151811061045b5761045b61108a565b602090810291909101015261046f816110b6565b9050610404565b509392505050565b6104893383836106af565b5050565b6001600160a01b0385163314806104a957506104a9853361014b565b6104c55760405162461bcd60e51b81526004016101f39061103c565b61034d858585858561078f565b81518351146105345760405162461bcd60e51b815260206004820152602860248201527f455243313135353a2069647320616e6420616d6f756e7473206c656e677468206044820152670dad2e6dac2e8c6d60c31b60648201526084016101f3565b6001600160a01b03841661055a5760405162461bcd60e51b81526004016101f3906110cf565b3360005b845181101561064157600085828151811061057b5761057b61108a565b6020026020010151905060008583815181106105995761059961108a565b602090810291909101810151600084815280835260408082206001600160a01b038e1683529093529190912054909150818110156105e95760405162461bcd60e51b81526004016101f390611114565b6000838152602081815260408083206001600160a01b038e8116855292528083208585039055908b1682528120805484929061062690849061115e565b925050819055505050508061063a906110b6565b905061055e565b50846001600160a01b0316866001600160a01b0316826001600160a01b03167f4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb8787604051610691929190611176565b60405180910390a46106a78187878787876108b9565b505050505050565b816001600160a01b0316836001600160a01b0316036107225760405162461bcd60e51b815260206004820152602960248201527f455243313135353a2073657474696e6720617070726f76616c20737461747573604482015268103337b91039b2b63360b91b60648201526084016101f3565b6001600160a01b03838116600081815260016020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0384166107b55760405162461bcd60e51b81526004016101f3906110cf565b3360006107c185610a1d565b905060006107ce85610a1d565b90506000868152602081815260408083206001600160a01b038c168452909152902054858110156108115760405162461bcd60e51b81526004016101f390611114565b6000878152602081815260408083206001600160a01b038d8116855292528083208985039055908a1682528120805488929061084e90849061115e565b909155505060408051888152602081018890526001600160a01b03808b16928c821692918816917fc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62910160405180910390a46108ae848a8a8a8a8a610a68565b505050505050505050565b6001600160a01b0384163b156106a75760405163bc197c8160e01b81526001600160a01b0385169063bc197c81906108fd90899089908890889088906004016111a4565b6020604051808303816000875af1925050508015610938575060408051601f3d908101601f1916820190925261093591810190611202565b60015b6109e45761094461121f565b806308c379a00361097d575061095861123b565b80610963575061097f565b8060405162461bcd60e51b81526004016101f39190610c0c565b505b60405162461bcd60e51b815260206004820152603460248201527f455243313135353a207472616e7366657220746f206e6f6e2d455243313135356044820152732932b1b2b4bb32b91034b6b83632b6b2b73a32b960611b60648201526084016101f3565b6001600160e01b0319811663bc197c8160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b50505050505050565b60408051600180825281830190925260609160009190602080830190803683370190505090508281600081518110610a5757610a5761108a565b602090810291909101015292915050565b6001600160a01b0384163b156106a75760405163f23a6e6160e01b81526001600160a01b0385169063f23a6e6190610aac908990899088908890889060040161130d565b6020604051808303816000875af1925050508015610ae7575060408051601f3d908101601f19168201909252610ae491810190611202565b60015b610af35761094461121f565b6001600160e01b0319811663f23a6e6160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b80356001600160a01b0381168114610b3a57600080fd5b919050565b60008060408385031215610b5257600080fd5b610b5b83610b23565b946020939093013593505050565b6001600160e01b031981168114610b7f57600080fd5b50565b600060208284031215610b9457600080fd5b8135610b9f81610b69565b9392505050565b600060208284031215610bb857600080fd5b5035919050565b6000815180845260005b81811015610be557602081850181015186830182015201610bc9565b81811115610bf7576000602083870101525b50601f01601f19169290920160200192915050565b602081526000610b9f6020830184610bbf565b634e487b7160e01b600052604160045260246000fd5b601f8201601f1916810167ffffffffffffffff81118282101715610c5b57610c5b610c1f565b6040525050565b600067ffffffffffffffff821115610c7c57610c7c610c1f565b5060051b60200190565b600082601f830112610c9757600080fd5b81356020610ca482610c62565b604051610cb18282610c35565b83815260059390931b8501820192828101915086841115610cd157600080fd5b8286015b84811015610cec5780358352918301918301610cd5565b509695505050505050565b600082601f830112610d0857600080fd5b813567ffffffffffffffff811115610d2257610d22610c1f565b604051610d39601f8301601f191660200182610c35565b818152846020838601011115610d4e57600080fd5b816020850160208301376000918101602001919091529392505050565b600080600080600060a08688031215610d8357600080fd5b610d8c86610b23565b9450610d9a60208701610b23565b9350604086013567ffffffffffffffff80821115610db757600080fd5b610dc389838a01610c86565b94506060880135915080821115610dd957600080fd5b610de589838a01610c86565b93506080880135915080821115610dfb57600080fd5b50610e0888828901610cf7565b9150509295509295909350565b60008060408385031215610e2857600080fd5b823567ffffffffffffffff80821115610e4057600080fd5b818501915085601f830112610e5457600080fd5b81356020610e6182610c62565b604051610e6e8282610c35565b83815260059390931b8501820192828101915089841115610e8e57600080fd5b948201945b83861015610eb357610ea486610b23565b82529482019490820190610e93565b96505086013592505080821115610ec957600080fd5b50610ed685828601610c86565b9150509250929050565b600081518084526020808501945080840160005b83811015610f1057815187529582019590820190600101610ef4565b509495945050505050565b602081526000610b9f6020830184610ee0565b60008060408385031215610f4157600080fd5b610f4a83610b23565b915060208301358015158114610f5f57600080fd5b809150509250929050565b60008060408385031215610f7d57600080fd5b610f8683610b23565b9150610f9460208401610b23565b90509250929050565b600080600080600060a08688031215610fb557600080fd5b610fbe86610b23565b9450610fcc60208701610b23565b93506040860135925060608601359150608086013567ffffffffffffffff811115610ff657600080fd5b610e0888828901610cf7565b600181811c9082168061101657607f821691505b60208210810361103657634e487b7160e01b600052602260045260246000fd5b50919050565b6020808252602e908201527f455243313135353a2063616c6c6572206973206e6f7420746f6b656e206f776e60408201526d195c881bdc88185c1c1c9bdd995960921b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b6000600182016110c8576110c86110a0565b5060010190565b60208082526025908201527f455243313135353a207472616e7366657220746f20746865207a65726f206164604082015264647265737360d81b606082015260800190565b6020808252602a908201527f455243313135353a20696e73756666696369656e742062616c616e636520666f60408201526939103a3930b739b332b960b11b606082015260800190565b60008219821115611171576111716110a0565b500190565b6040815260006111896040830185610ee0565b828103602084015261119b8185610ee0565b95945050505050565b6001600160a01b0386811682528516602082015260a0604082018190526000906111d090830186610ee0565b82810360608401526111e28186610ee0565b905082810360808401526111f68185610bbf565b98975050505050505050565b60006020828403121561121457600080fd5b8151610b9f81610b69565b600060033d11156112385760046000803e5060005160e01c5b90565b600060443d10156112495790565b6040516003193d81016004833e81513d67ffffffffffffffff816024840111818411171561127957505050505090565b82850191508151818111156112915750505050505090565b843d87010160208285010111156112ab5750505050505090565b6112ba60208286010187610c35565b509095945050505050565b60208082526028908201527f455243313135353a204552433131353552656365697665722072656a656374656040820152676420746f6b656e7360c01b606082015260800190565b6001600160a01b03868116825285166020820152604081018490526060810183905260a06080820181905260009061134790830184610bbf565b97965050505050505056fea2646970667358221220a690293c88d6344935ce74699232e93a05c2c54bc9e019a4c16e196e6916539864736f6c634300080d0033","deployedBytecode":"0x608060405234801561001057600080fd5b50600436106100875760003560e01c80634e1273f41161005b5780634e1273f41461010a578063a22cb4651461012a578063e985e9c51461013d578063f242432a1461017957600080fd5b8062fdd58e1461008c57806301ffc9a7146100b25780630e89341c146100d55780632eb2c2d6146100f5575b600080fd5b61009f61009a366004610b3f565b61018c565b6040519081526020015b60405180910390f35b6100c56100c0366004610b82565b610222565b60405190151581526020016100a9565b6100e86100e3366004610ba6565b610274565b6040516100a99190610c0c565b610108610103366004610d6b565b610308565b005b61011d610118366004610e15565b610354565b6040516100a99190610f1b565b610108610138366004610f2e565b61047e565b6100c561014b366004610f6a565b6001600160a01b03918216600090815260016020908152604080832093909416825291909152205460ff1690565b610108610187366004610f9d565b61048d565b60006001600160a01b0383166101fc5760405162461bcd60e51b815260206004820152602a60248201527f455243313135353a2061646472657373207a65726f206973206e6f742061207660448201526930b634b21037bbb732b960b11b60648201526084015b60405180910390fd5b506000908152602081815260408083206001600160a01b03949094168352929052205490565b60006001600160e01b03198216636cdb3d1360e11b148061025357506001600160e01b031982166303a24d0760e21b145b8061026e57506301ffc9a760e01b6001600160e01b03198316145b92915050565b60606002805461028390611002565b80601f01602080910402602001604051908101604052809291908181526020018280546102af90611002565b80156102fc5780601f106102d1576101008083540402835291602001916102fc565b820191906000526020600020905b8154815290600101906020018083116102df57829003601f168201915b50505050509050919050565b6001600160a01b0385163314806103245750610324853361014b565b6103405760405162461bcd60e51b81526004016101f39061103c565b61034d85858585856104d2565b5050505050565b606081518351146103b95760405162461bcd60e51b815260206004820152602960248201527f455243313135353a206163636f756e747320616e6420696473206c656e677468604482015268040dad2e6dac2e8c6d60bb1b60648201526084016101f3565b6000835167ffffffffffffffff8111156103d5576103d5610c1f565b6040519080825280602002602001820160405280156103fe578160200160208202803683370190505b50905060005b8451811015610476576104498582815181106104225761042261108a565b602002602001015185838151811061043c5761043c61108a565b602002602001015161018c565b82828151811061045b5761045b61108a565b602090810291909101015261046f816110b6565b9050610404565b509392505050565b6104893383836106af565b5050565b6001600160a01b0385163314806104a957506104a9853361014b565b6104c55760405162461bcd60e51b81526004016101f39061103c565b61034d858585858561078f565b81518351146105345760405162461bcd60e51b815260206004820152602860248201527f455243313135353a2069647320616e6420616d6f756e7473206c656e677468206044820152670dad2e6dac2e8c6d60c31b60648201526084016101f3565b6001600160a01b03841661055a5760405162461bcd60e51b81526004016101f3906110cf565b3360005b845181101561064157600085828151811061057b5761057b61108a565b6020026020010151905060008583815181106105995761059961108a565b602090810291909101810151600084815280835260408082206001600160a01b038e1683529093529190912054909150818110156105e95760405162461bcd60e51b81526004016101f390611114565b6000838152602081815260408083206001600160a01b038e8116855292528083208585039055908b1682528120805484929061062690849061115e565b925050819055505050508061063a906110b6565b905061055e565b50846001600160a01b0316866001600160a01b0316826001600160a01b03167f4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb8787604051610691929190611176565b60405180910390a46106a78187878787876108b9565b505050505050565b816001600160a01b0316836001600160a01b0316036107225760405162461bcd60e51b815260206004820152602960248201527f455243313135353a2073657474696e6720617070726f76616c20737461747573604482015268103337b91039b2b63360b91b60648201526084016101f3565b6001600160a01b03838116600081815260016020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0384166107b55760405162461bcd60e51b81526004016101f3906110cf565b3360006107c185610a1d565b905060006107ce85610a1d565b90506000868152602081815260408083206001600160a01b038c168452909152902054858110156108115760405162461bcd60e51b81526004016101f390611114565b6000878152602081815260408083206001600160a01b038d8116855292528083208985039055908a1682528120805488929061084e90849061115e565b909155505060408051888152602081018890526001600160a01b03808b16928c821692918816917fc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62910160405180910390a46108ae848a8a8a8a8a610a68565b505050505050505050565b6001600160a01b0384163b156106a75760405163bc197c8160e01b81526001600160a01b0385169063bc197c81906108fd90899089908890889088906004016111a4565b6020604051808303816000875af1925050508015610938575060408051601f3d908101601f1916820190925261093591810190611202565b60015b6109e45761094461121f565b806308c379a00361097d575061095861123b565b80610963575061097f565b8060405162461bcd60e51b81526004016101f39190610c0c565b505b60405162461bcd60e51b815260206004820152603460248201527f455243313135353a207472616e7366657220746f206e6f6e2d455243313135356044820152732932b1b2b4bb32b91034b6b83632b6b2b73a32b960611b60648201526084016101f3565b6001600160e01b0319811663bc197c8160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b50505050505050565b60408051600180825281830190925260609160009190602080830190803683370190505090508281600081518110610a5757610a5761108a565b602090810291909101015292915050565b6001600160a01b0384163b156106a75760405163f23a6e6160e01b81526001600160a01b0385169063f23a6e6190610aac908990899088908890889060040161130d565b6020604051808303816000875af1925050508015610ae7575060408051601f3d908101601f19168201909252610ae491810190611202565b60015b610af35761094461121f565b6001600160e01b0319811663f23a6e6160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b80356001600160a01b0381168114610b3a57600080fd5b919050565b60008060408385031215610b5257600080fd5b610b5b83610b23565b946020939093013593505050565b6001600160e01b031981168114610b7f57600080fd5b50565b600060208284031215610b9457600080fd5b8135610b9f81610b69565b9392505050565b600060208284031215610bb857600080fd5b5035919050565b6000815180845260005b81811015610be557602081850181015186830182015201610bc9565b81811115610bf7576000602083870101525b50601f01601f19169290920160200192915050565b602081526000610b9f6020830184610bbf565b634e487b7160e01b600052604160045260246000fd5b601f8201601f1916810167ffffffffffffffff81118282101715610c5b57610c5b610c1f565b6040525050565b600067ffffffffffffffff821115610c7c57610c7c610c1f565b5060051b60200190565b600082601f830112610c9757600080fd5b81356020610ca482610c62565b604051610cb18282610c35565b83815260059390931b8501820192828101915086841115610cd157600080fd5b8286015b84811015610cec5780358352918301918301610cd5565b509695505050505050565b600082601f830112610d0857600080fd5b813567ffffffffffffffff811115610d2257610d22610c1f565b604051610d39601f8301601f191660200182610c35565b818152846020838601011115610d4e57600080fd5b816020850160208301376000918101602001919091529392505050565b600080600080600060a08688031215610d8357600080fd5b610d8c86610b23565b9450610d9a60208701610b23565b9350604086013567ffffffffffffffff80821115610db757600080fd5b610dc389838a01610c86565b94506060880135915080821115610dd957600080fd5b610de589838a01610c86565b93506080880135915080821115610dfb57600080fd5b50610e0888828901610cf7565b9150509295509295909350565b60008060408385031215610e2857600080fd5b823567ffffffffffffffff80821115610e4057600080fd5b818501915085601f830112610e5457600080fd5b81356020610e6182610c62565b604051610e6e8282610c35565b83815260059390931b8501820192828101915089841115610e8e57600080fd5b948201945b83861015610eb357610ea486610b23565b82529482019490820190610e93565b96505086013592505080821115610ec957600080fd5b50610ed685828601610c86565b9150509250929050565b600081518084526020808501945080840160005b83811015610f1057815187529582019590820190600101610ef4565b509495945050505050565b602081526000610b9f6020830184610ee0565b60008060408385031215610f4157600080fd5b610f4a83610b23565b915060208301358015158114610f5f57600080fd5b809150509250929050565b60008060408385031215610f7d57600080fd5b610f8683610b23565b9150610f9460208401610b23565b90509250929050565b600080600080600060a08688031215610fb557600080fd5b610fbe86610b23565b9450610fcc60208701610b23565b93506040860135925060608601359150608086013567ffffffffffffffff811115610ff657600080fd5b610e0888828901610cf7565b600181811c9082168061101657607f821691505b60208210810361103657634e487b7160e01b600052602260045260246000fd5b50919050565b6020808252602e908201527f455243313135353a2063616c6c6572206973206e6f7420746f6b656e206f776e60408201526d195c881bdc88185c1c1c9bdd995960921b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b6000600182016110c8576110c86110a0565b5060010190565b60208082526025908201527f455243313135353a207472616e7366657220746f20746865207a65726f206164604082015264647265737360d81b606082015260800190565b6020808252602a908201527f455243313135353a20696e73756666696369656e742062616c616e636520666f60408201526939103a3930b739b332b960b11b606082015260800190565b60008219821115611171576111716110a0565b500190565b6040815260006111896040830185610ee0565b828103602084015261119b8185610ee0565b95945050505050565b6001600160a01b0386811682528516602082015260a0604082018190526000906111d090830186610ee0565b82810360608401526111e28186610ee0565b905082810360808401526111f68185610bbf565b98975050505050505050565b60006020828403121561121457600080fd5b8151610b9f81610b69565b600060033d11156112385760046000803e5060005160e01c5b90565b600060443d10156112495790565b6040516003193d81016004833e81513d67ffffffffffffffff816024840111818411171561127957505050505090565b82850191508151818111156112915750505050505090565b843d87010160208285010111156112ab5750505050505090565b6112ba60208286010187610c35565b509095945050505050565b60208082526028908201527f455243313135353a204552433131353552656365697665722072656a656374656040820152676420746f6b656e7360c01b606082015260800190565b6001600160a01b03868116825285166020820152604081018490526060810183905260a06080820181905260009061134790830184610bbf565b97965050505050505056fea2646970667358221220a690293c88d6344935ce74699232e93a05c2c54bc9e019a4c16e196e6916539864736f6c634300080d0033","linkReferences":{},"deployedLinkReferences":{}}');var k=n(785947),N=n(129624),O=n(206391),D=n.n(O),C=n(629503),F=n(519817),S=n(901187),B=n(740727),R=n(776553),H=n(317279),M=n(942013),K=n(613549),L=n(292147),_=n(396564),U=n(665417),j=n(992431),G=n(940915),V=n(133563),$=n(278489),W=n(790656),J=n(683094),z=n(794292),Y=n(655697),q=n(966852),Q=n(572801),X=n(556658),Z=n(63450),ee=n(398514),te=n(392853),ne=n(786141),re=n(389342),ae=n(258387),oe=n(73485),ie=n(153546),de=n(814817),ce=n(967640),ue=n(59256),se=n(313390),fe=n(291026),le=n(368445),pe=n(348834).Buffer;function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,v.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(){return he=(0,g.default)((function*(e,t,n,r){var a,o,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0;try{o=yield e.evmGetAddress(t,n,ye({path:r,showOnOneKey:i,chainId:c},d))}catch(u){throw console.error(u),new G.OneKeyHardwareError(u)}if(o.success&&null!=(a=o.payload)&&a.address)return de.fixAddressCase({address:o.payload.address,impl:K.IMPL_EVM});throw(0,ie.convertDeviceError)(o.payload)})),he.apply(this,arguments)}function ve(e){if(!e.success)throw(0,ie.convertDeviceError)(e.payload);return e.payload}function me(){return(me=(0,g.default)((function*(e){var t=e.HardwareSDK,n=e.connectId,r=e.deviceId,a=e.passphraseState,o=e.path,i=e.message,d=e.chainId;if(i.type===Q.ETHMessageTypes.TYPED_DATA_V1)throw fe.web3Errors.provider.unsupportedMethod(`Sign message method=${i.type} not supported for this device`);if(i.type===Q.ETHMessageTypes.ETH_SIGN||i.type===Q.ETHMessageTypes.PERSONAL_SIGN){var c;try{if(!(0,R.isHexString)(i.message))throw new Error("not hex string");c=pe.from(i.message.replace("0x",""),"hex")}catch(g){c=pe.from("")}var u=i.message;0===c.length&&(u=pe.from(i.message,"utf-8").toString("hex"));var s=yield t.evmSignMessage(n,r,ye({path:o,messageHex:u,chainId:d},a));if(!s.success)throw(0,ie.convertDeviceError)(s.payload);var f=ve(s);return`0x${(null==f?void 0:f.signature)||""}`}if(i.type===Q.ETHMessageTypes.TYPED_DATA_V3||i.type===Q.ETHMessageTypes.TYPED_DATA_V4){var l=i.type===Q.ETHMessageTypes.TYPED_DATA_V4,p=JSON.parse(i.message),b=le.TypedDataUtils.sanitizeData(p),y=le.TypedDataUtils.hashStruct("EIP712Domain",b.domain,b.types,l).toString("hex"),h=le.TypedDataUtils.hashStruct(b.primaryType,b.message,b.types,l).toString("hex"),v=yield t.evmSignTypedData(n,r,ye({path:o,metamaskV4Compat:!!l,data:p,domainHash:y,messageHash:h,chainId:d},a));if(!v.success)throw(0,ie.convertDeviceError)(v.payload);var m=ve(v);return`0x${(null==m?void 0:m.signature)||""}`}throw fe.web3Errors.rpc.methodNotFound(`Sign message method=${i.type} not found`)}))).apply(this,arguments)}function ge(){return(ge=(0,g.default)((function*(e,t,n,r,a,o,i){var d,c,u,s,f=o.outputs[0];if("undefined"===typeof f.tokenAddress?(u=f.address,s=(0,U.toBigIntHex)(f.value)):(u=f.tokenAddress,s="0x0"),"undefined"===typeof o.feeLimit||"undefined"===typeof o.nonce)throw new G.OneKeyInternalError("Incomplete unsigned tx.");var l,p,b,y,h=null==(d=o.payload)?void 0:d.EIP1559Enabled;h?l={to:u,value:s,gasLimit:(0,U.toBigIntHex)(o.feeLimit),nonce:`0x${o.nonce.toString(16)}`,data:(null==(p=o.payload)?void 0:p.data)||"0x",chainId:parseInt(a),maxFeePerGas:(0,U.toBigIntHex)(o.payload.maxFeePerGas),maxPriorityFeePerGas:(0,U.toBigIntHex)(o.payload.maxPriorityFeePerGas)}:l={to:u,value:s,gasPrice:(0,U.toBigIntHex)(null!=(b=o.feePricePerUnit)?b:new O.BigNumber(0)),gasLimit:(0,U.toBigIntHex)(o.feeLimit),nonce:`0x${o.nonce.toString(16)}`,data:(null==(y=o.payload)?void 0:y.data)||"0x",chainId:parseInt(a)};var v,m,g,w,T={to:l.to,value:l.value,gasPrice:l.gasPrice,gasLimit:l.gasLimit,nonce:parseInt(l.nonce,16),data:l.data,chainId:l.chainId};h&&(T.type=2,T.maxFeePerGas=null!=(v=null==(m=l)?void 0:m.maxFeePerGas)?v:void 0,T.maxPriorityFeePerGas=null!=(g=null==(w=l)?void 0:w.maxPriorityFeePerGas)?g:void 0);try{c=yield e.evmSignTransaction(t,n,ye({path:r,transaction:l},i))}catch(N){throw console.error(N),new G.OneKeyHardwareError(N)}if(c.success){var x=c.payload,I=x.v,A=x.r,E=x.s,P=(0,ce.splitSignature)({v:Number(I),r:A,s:E}),k=(0,se.serialize)(T,P);return{txid:(0,ue.keccak256)(k),rawTx:k}}throw(0,ie.convertDeviceError)(c.payload)}))).apply(this,arguments)}function we(){return(we=(0,g.default)((function*(e,t,n,r,a,o,i,d,c){if(t!==K.IMPL_EVM||"address"!==r)return Promise.resolve([]);var u,s=n.length>1;try{u=s?yield e.evmGetAddress(o,i,ye({bundle:n.map((function(e){return{path:e,showOnOneKey:!1,chainId:c}}))},d)):yield e.evmGetAddress(o,i,ye({path:n[0],showOnOneKey:!1,chainId:c},d))}catch(f){throw console.error(f),new G.OneKeyHardwareError(f)}if(u.success)return u.payload instanceof Array?u.payload.map((function(e){var n=e.path,r=e.address;return{path:n,info:de.fixAddressCase({address:r,impl:t})}})):[{path:u.payload.path,info:de.fixAddressCase({address:u.payload.address,impl:t})}];throw(0,ie.convertDeviceError)(u.payload)}))).apply(this,arguments)}var Te=n(997293),xe=n(398145),Ie=n(82406),Ae=n(779846);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,v.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,A.default)(e);if(t){var a=(0,A.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,I.default)(this,n)}}var Ne=function(e){(0,x.default)(n,e);var t=ke(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=(0,g.default)((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getAccountPath(),r=yield this.getNetworkChainId(),a=yield this.getHardwareInfo();return function(e,t,n,r,a,o,i){return ge.apply(this,arguments)}(t,a.connectId,a.deviceId,n,r,e,yield this.getWalletPassphraseState())}));return function(t){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=(0,g.default)((function*(e,t){var n=yield this.getHardwareSDKInstance(),r=yield this.getAccountPath(),a=yield this.getNetworkChainId(),o=yield this.getHardwareInfo(),i=o.connectId,d=o.deviceId,c=yield this.getWalletPassphraseState();return Promise.all(e.map((function(e){return function(e){return me.apply(this,arguments)}({HardwareSDK:n,connectId:i,deviceId:d,passphraseState:c,path:r,message:e,chainId:Number(a)})})))}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=(0,g.default)((function*(e){var t,n=this,r=yield this.getHardwareSDKInstance(),a=yield this.getNetworkChainId(),o=yield this.getHardwareInfo(),i=o.connectId,d=o.deviceId,c=yield this.getWalletPassphraseState(),u=e.indexes,s=e.names,f=e.type,l=e.template,p=e.coinType,b=(0,Te.slicePathTemplate)(l),y=b.pathPrefix,h=b.pathSuffix,v=l===(yield this.vault.getAccountNameInfoMap()).ledgerLive.template,m=u.map((function(e){return`${y}/${h.replace("{index}",`${e}`)}`}));if("SEARCH_ACCOUNTS"===f){var w,T={path:y,showOnOneKey:!1,chainId:Number(a)};v&&(T={bundle:m.map((function(e){return{path:e,showOnOneKey:!1,chainId:Number(a)}})),useBatch:!0});try{w=yield r.evmGetPublicKey(i,d,Pe(Pe({},T),c))}catch(S){throw L.default.engine.error(S),new G.OneKeyHardwareError(S)}if(!w.success)throw(0,ie.convertDeviceError)(w.payload);if(v)t=yield Promise.all(w.payload.map(function(){var e=(0,g.default)((function*(e){return{path:e.path,info:de.fixAddressCase({address:yield n.engine.providerManager.addressFromPub(n.networkId,e.publicKey),impl:K.IMPL_EVM})}}));return function(t){return e.apply(this,arguments)}}()));else{var x=w.payload.xpub,I=Ae.utils.HDNode.fromExtendedKey(x);t=u.map((function(e){return{path:`${y}/${h.replace("{index}",`${e}`)}`,info:de.fixAddressCase({address:I.derivePath(`${e}`).address,impl:K.IMPL_EVM})}}))}}else t=yield function(e,t,n,r,a,o,i,d,c){return we.apply(this,arguments)}(r,K.IMPL_EVM,m,"address",f,i,d,c,Number(a));var A=[],E=0,P=yield this.getNetworkImpl(),k=(0,$.getAccountNameInfoByTemplate)(P,l).prefix,N=(0,$.getAccountNameInfoByImpl)(P).ledgerLive.template===l;for(var O of t){var D=O.path,C=O.info,F=(s||[])[E]||`${k} #${u[E]+1}`;A.push({id:N?`${this.walletId}--${D}--LedgerLive`:`${this.walletId}--${D}`,name:F,type:xe.AccountType.SIMPLE,path:D,coinType:p,pub:"",address:C,template:l}),E+=1}return A}));return function(t){return e.apply(this,arguments)}}(),r.getAddress=function(){var e=(0,g.default)((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getNetworkChainId(),r=yield this.getHardwareInfo(),a=r.connectId,o=r.deviceId,i=yield this.getWalletPassphraseState(),d=yield function(e,t,n,r){return he.apply(this,arguments)}(t,a,o,e.path,e.showOnOneKey,i,Number(n));return d}));return function(t){return e.apply(this,arguments)}}(),r.batchGetAddress=function(){var e=(0,g.default)((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getNetworkChainId(),r=yield this.getHardwareInfo(),a=r.connectId,o=r.deviceId,i=yield this.getWalletPassphraseState(),d=yield t.evmGetAddress(a,o,Pe(Pe({},i),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey,chainId:Number(n)}}))}));if(!d.success)throw(0,ie.convertDeviceError)(d.payload);return d.payload.map((function(e){var t,n;return{path:null!=(t=e.path)?t:"",address:null!=(n=e.address)?n:""}}))}));return function(t){return e.apply(this,arguments)}}(),(0,w.default)(n)}(Ie.KeyringHardwareBase),Oe=n(605851);function De(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,A.default)(e);if(t){var a=(0,A.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,I.default)(this,n)}}var Ce=function(e){(0,x.default)(n,e);var t=De(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=(0,g.default)((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new G.OneKeyInternalError("EVM signers number should be 1.");if(t[0]!==r.address)throw new G.OneKeyInternalError("Wrong address required for signing.");var a=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof a)throw new G.OneKeyInternalError("Unable to get signer.");return(n={})[r.address]=new z.Signer(a,e,"secp256k1"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=(0,g.default)((function*(e){var t=e.password,n=e.indexes,r=e.names,a=e.coinType,o=e.template,i=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,d=(0,Te.slicePathTemplate)(o),c=d.pathPrefix,u=d.pathSuffix,s=(0,Oe.batchGetPublicKeys)("secp256k1",i,t,c,n.map((function(e){return u.replace("{index}",e.toString())})));if(s.length!==n.length)throw new G.OneKeyInternalError("Unable to get publick key.");var f=[],l=0,p=yield this.getNetworkImpl(),b=(0,$.getAccountNameInfoByTemplate)(p,o).prefix;for(var y of s){var h=y.path,v=y.extendedKey.key.toString("hex"),m=yield this.engine.providerManager.addressFromPub(this.networkId,v),g=(r||[])[l]||`${b} #${n[l]+1}`,w=(0,$.getAccountNameInfoByImpl)(p).ledgerLive.template===o;f.push({id:w?`${this.walletId}--${h}--LedgerLive`:`${this.walletId}--${h}`,name:g,type:xe.AccountType.SIMPLE,path:h,coinType:a,pub:v,address:m,template:o}),l+=1}return f}));return function(t){return e.apply(this,arguments)}}(),(0,w.default)(n)}(n(810887).KeyringHdBase),Fe=n(478557);function Se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,A.default)(e);if(t){var a=(0,A.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,I.default)(this,n)}}var Be=function(e){(0,x.default)(n,e);var t=Se(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=(0,g.default)((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new G.OneKeyInternalError("EVM signers number should be 1.");if(t[0]!==r.address)throw new G.OneKeyInternalError("Wrong address required for signing.");var a=Object.values(yield this.getPrivateKeys(e)),o=(0,m.default)(a,1)[0];return(n={})[r.address]=new z.Signer(o,e,"secp256k1"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=(0,g.default)((function*(e){var t=e.name,n=e.privateKey;if(32!==n.length)throw new G.OneKeyInternalError("Invalid private key.");var r=Fe.secp256k1.publicFromPrivate(n).toString("hex"),a=yield this.engine.providerManager.addressFromPub(this.networkId,r);return Promise.resolve([{id:`imported--${K.COINTYPE_ETH}--${r}`,name:t||"",type:xe.AccountType.SIMPLE,path:"",coinType:K.COINTYPE_ETH,pub:r,address:a}])}));return function(t){return e.apply(this,arguments)}}(),(0,w.default)(n)}(n(255942).KeyringImportedBase);function Re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,A.default)(e);if(t){var a=(0,A.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,I.default)(this,n)}}var He=function(e){(0,x.default)(n,e);var t=Re(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=(0,g.default)((function*(e,t){var n,r=null==(n=e.payload)?void 0:n.encodedTx,a=yield this.getDbAccount();return L.default.sendTx.info("KeyringWatching > signTransaction >>>>> ",a.address,r),Promise.resolve({txid:"1111",rawTx:"11118888"})}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=(0,g.default)((function*(e){var t=e.name,n=e.target,r=e.accountIdPrefix,a=yield this.engine.providerManager.verifyAddress(this.networkId,n),o=a.normalizedAddress;if(!a.isValid||"undefined"===typeof o)throw new G.InvalidAddress;return Promise.resolve([{id:`${r}--${K.COINTYPE_ETH}--${o}`,name:t||"",type:xe.AccountType.SIMPLE,path:"",coinType:K.COINTYPE_ETH,pub:"",address:o}])}));return function(t){return e.apply(this,arguments)}}(),(0,w.default)(n)}(n(701625).KeyringWatchingBase),Me=n(816610),Ke=["from","to","value","data","customData","gas","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce"],Le=["gas","gasLimit"];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,v.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,A.default)(e);if(t){var a=(0,A.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,I.default)(this,n)}}var Ge,Ve=[M.OnekeyNetwork.optimism,M.OnekeyNetwork.toptimism,M.OnekeyNetwork.base],$e=N.abi,We=P.abi,Je=k.abi;function ze(e){var t,n,r,a,o,i;return{feeLimit:new(D())(null!=(t=e.feeLimit)?t:0).toFixed(),feePricePerUnit:new(D())(null!=(n=e.feePricePerUnit)?n:0).toFixed(),maxPriorityFeePerGas:new(D())(null!=(r=null==(a=e.payload)?void 0:a.maxPriorityFeePerGas)?r:0).toFixed(),maxFeePerGas:new(D())(null!=(o=null==(i=e.payload)?void 0:i.maxFeePerGas)?o:0).toFixed()}}!function(e){e.NativeTransfer="NativeTransfer",e.TokenTransfer="TokenTransfer",e.TokenApprove="TokenApprove",e.Swap="Swap",e.NftTransfer="NftTransfer",e.Transaction="Transaction",e.ContractDeploy="ContractDeploy"}(Ge||(Ge={}));var Ye=function(e){(0,x.default)(n,e);var t=je(n);function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).settings=Me.default,e.keyringMap={hd:Ce,hw:Ne,imported:Be,watching:He,external:He},e.decodeTxMemoizee=(0,_.memoizee)(function(){var t=(0,g.default)((function*(t,n){return e.decodeTx(t,n)}));return function(e,n){return t.apply(this,arguments)}}(),{promise:!0,primitive:!0,max:1,maxAge:(0,R.getTimeDurationMs)({minute:3})}),e.isContractAddress=(0,_.memoizee)(function(){var t=(0,g.default)((function*(t){try{yield e.validateAddress(t);var n=yield e.getJsonRPCClient();return yield n.isContract(t)}catch(r){return Promise.resolve(!1)}}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:50}),e}var r=n.prototype;return r.getEthersProvider=function(){var e=(0,g.default)((function*(){var e,t,n=yield this.getNetwork(),r=n.rpcURL;return this._ethersProvider&&(null==(e=this._ethersProvider)||null==(t=e.connection)?void 0:t.url)===r||(this._ethersProvider=new Ae.providers.JsonRpcProvider(n.rpcURL)),this._ethersProvider}));return function(){return e.apply(this,arguments)}}(),r.getJsonRPCClient=function(){var e=(0,g.default)((function*(){return yield this.engine.providerManager.getClient(this.networkId)}));return function(){return e.apply(this,arguments)}}(),r.decodedTxToLegacy=function(e){throw new Error("decodedTxToLegacy in EVM not implemented.")},r.decodeTx=function(){var e=(0,g.default)((function*(e,t){var n=yield this.legacyDecodeTx(e,t);return yield this.decodedTxLegacyToModern({decodedTxLegacy:n,encodedTx:e,payload:t})}));return function(t,n){return e.apply(this,arguments)}}(),r.decodeBatchTransferTx=function(){var e=(0,g.default)((function*(e,t,n){var r,a=ae.EVMTxDecoder.getDecoder(this.engine),o=yield this.helper.parseToNativeTx(t);Number.isFinite(o.chainId)||(o.chainId=Number(yield this.getNetworkChainId()));var i=a.parseBatchTransfer(o),d=(0,m.default)(i,1)[0];if(!d)return null;var c=[],u=yield this.getNetwork(),s=yield this.getAccountAddress();switch(d.name){case"disperseEther":for(var f=d.args[0],l=d.args[1],p=yield this.engine.getNativeTokenInfo(this.networkId),b=0;b<f.length;b+=1)c.push({type:ee.IDecodedTxActionType.NATIVE_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:f[b],address:s}),nativeTransfer:yield this.buildNativeTransferAction({fromAddress:t.from,toAddress:f[b],amount:new(D())(l[b].toString()).shiftedBy(-p.decimals).toFixed(),value:l[b].toString()})});break;case"disperseToken":case"disperseTokenSimple":var y=d.args[0],h=d.args[1],v=d.args[2],g=yield this.engine.ensureTokenInDB(this.networkId,y);if(!g)break;for(var w=0;w<h.length;w+=1)c.push({type:ee.IDecodedTxActionType.TOKEN_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:h[w],address:s}),tokenTransfer:yield this.buildTokenTransferAction({info:{token:g,from:t.from,recipient:h[w],amount:new(D())(v[w].toString()).shiftedBy(-g.decimals).toFixed(),amountValue:v[w].toString()}})});break;case"disperseNFT":for(var T=d.args[0],x=d.args[1],I=d.args[2],A=d.args[3],E=0;E<A.length;E+=1){var P,k=(null==n||null==(P=n.nftInfos)?void 0:P[E].asset)||(yield(0,W.getAsset)({accountId:this.accountId,networkId:this.networkId,contractAddress:x[E],tokenId:new(D())(I[E].toString()).toFixed(),local:!0}));k&&c.push({type:ee.IDecodedTxActionType.NFT_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:T,address:s}),nftTransfer:yield this.buildNFTTransferAcion({asset:k,amount:new(D())(A[E].toString()).toFixed(),from:t.from,to:T})})}break;default:return null}var N,O=e.gasInfo,C=new(D())(O.gasLimit).toFixed();return N=O.maxFeePerGas?{eip1559:!0,limit:C,price1559:{baseFee:"0",maxPriorityFeePerGas:new(D())(O.maxPriorityFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),maxPriorityFeePerGasValue:O.maxPriorityFeePerGas,maxFeePerGas:new(D())(O.maxFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),maxFeePerGasValue:O.maxFeePerGas,gasPrice:new(D())(O.gasPrice||O.maxFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),gasPriceValue:O.gasPrice||O.maxFeePerGas}}:{limit:C,price:new(D())(O.gasPrice).shiftedBy(-u.feeDecimals).toFixed(),priceValue:O.gasPrice},{txid:e.txHash,owner:s,signer:t.from||s,nonce:new(D())(null!=(r=t.nonce)?r:0).toNumber(),actions:[].concat(c),status:ee.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:t,feeInfo:N,payload:n,extraInfo:null}}));return function(t,n,r){return e.apply(this,arguments)}}(),r.legacyDecodeTx=function(){var e=(0,g.default)((function*(e,t){var n=yield this.helper.parseToNativeTx(e);return Number.isFinite(n.chainId)||(n.chainId=Number(yield this.getNetworkChainId())),ae.EVMTxDecoder.getDecoder(this.engine).decodeTx({vault:this,rawTx:n,payload:t})}));return function(t,n){return e.apply(this,arguments)}}(),r.decodedTxLegacyToModern=function(){var e=(0,g.default)((function*(e){var t,n=e.decodedTxLegacy,r=e.encodedTx,a=e.payload,o=e.interactInfo;if(r.to&&r.to.toLowerCase()===(null==(t=J.batchTransferContractAddress[this.networkId])?void 0:t.toLowerCase())){var i=yield this.decodeBatchTransferTx(n,r,a);if(i)return i}var d,c=yield this.getAccountAddress(),u=yield this.getNetwork(),s=yield this.engine.getNativeTokenInfo(this.networkId),f={type:ee.IDecodedTxActionType.UNKNOWN,direction:yield this.buildTxActionDirection({from:n.fromAddress,to:n.toAddress,address:c}),unknownAction:{extraInfo:{}}};if(r.value){var l=new(D())(r.value);!l.isNaN()&&l.gt(0)&&(d={type:ee.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:r.from||n.fromAddress,to:r.to,amount:l.shiftedBy(-u.decimals).toFixed(),amountValue:l.toFixed(),extraInfo:null}})}if(n.txType===ae.EVMDecodedTxType.NATIVE_TRANSFER&&(f.type=ee.IDecodedTxActionType.NATIVE_TRANSFER,f.nativeTransfer=yield this.buildNativeTransferAction(n),d=void 0),n.txType===ae.EVMDecodedTxType.TOKEN_TRANSFER&&(f.type=ee.IDecodedTxActionType.TOKEN_TRANSFER,f.tokenTransfer=yield this.buildTokenTransferAction(n)),n.txType===ae.EVMDecodedTxType.TOKEN_APPROVE){var p,b=n.info;f.type=ee.IDecodedTxActionType.TOKEN_APPROVE,f.tokenApprove={tokenInfo:b.token,owner:null!=(p=r.from)?p:c,spender:b.spender,amount:b.amount,amountValue:b.value,isMax:b.isUInt256Max,extraInfo:null}}if(n.txType===ae.EVMDecodedTxType.ERC721_TRANSFER||n.txType===ae.EVMDecodedTxType.ERC1155_TRANSFER){var y=null;if(null!=a&&a.nftInfo)y=null==a?void 0:a.nftInfo;else if(n.contractCallInfo){var h=n.contractCallInfo,v=h.args||[],g=(0,m.default)(v,4),w=g[0],T=g[1],x=g[2],I=g[3],A=yield(0,W.getAsset)({accountId:this.accountId,networkId:this.networkId,contractAddress:h.contractAddress,tokenId:x,local:!0});A&&(y={from:w,to:T,amount:new(D())(I).toFixed(),asset:A})}y&&(f.type=ee.IDecodedTxActionType.NFT_TRANSFER,f.nftTransfer=yield this.buildNFTTransferAcion(y))}"InternalSwap"===(null==a?void 0:a.type)&&null!=a&&a.swapInfo&&(f.internalSwap=Ue(Ue({},a.swapInfo),{},{extraInfo:null}),f.type=ee.IDecodedTxActionType.INTERNAL_SWAP,d=void 0),"InternalStake"===(null==a?void 0:a.type)&&null!=a&&a.stakeInfo&&(f.internalStake=Ue(Ue({},a.stakeInfo),{},{extraInfo:null}),f.type=ee.IDecodedTxActionType.INTERNAL_STAKE,d=void 0);var E,P=n.gasInfo,k=new(D())(P.gasLimit).toFixed();return E=P.maxFeePerGas?{eip1559:!0,limit:k,price1559:{baseFee:"0",maxPriorityFeePerGas:new(D())(P.maxPriorityFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),maxPriorityFeePerGasValue:P.maxPriorityFeePerGas,maxFeePerGas:new(D())(P.maxFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),maxFeePerGasValue:P.maxFeePerGas,gasPrice:new(D())(P.gasPrice||P.maxFeePerGas).shiftedBy(-u.feeDecimals).toFixed(),gasPriceValue:P.gasPrice||P.maxFeePerGas}}:{limit:k,price:new(D())(P.gasPrice).shiftedBy(-u.feeDecimals).toFixed(),priceValue:P.gasPrice},{txid:n.txHash,owner:c,signer:n.fromAddress,nonce:n.nonce||0,actions:[f,d].filter(Boolean),status:ee.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:r,payload:a,feeInfo:E,interactInfo:o,extraInfo:{}}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=(0,g.default)((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var t=yield this.getNetwork(),n=Boolean(e.token),r=e.amount,a=e.nftTokenId,o=e.isNFT,i=e.nftType,d=new(D())(r);if(d.isNaN()&&(d=new(D())("0")),n){var c,u;if(o&&i&&a){var s,f=(0,W.buildEncodeDataWithABI)({type:i,from:e.from,to:e.to,id:a,amount:d.toFixed()});return{from:e.from,to:null!=(s=e.token)?s:"",value:"0x0",data:f}}var l=yield this.engine.ensureTokenInDB(this.networkId,null!=(c=e.token)?c:"");if(!l)throw new Error(`Token not found: ${e.token}`);var p=(0,U.toBigIntHex)(d.shiftedBy(l.decimals)),b=`${re.Erc20MethodSelectors.tokenTransfer}${E.defaultAbiCoder.encode(["address","uint256"],[e.to,p]).slice(2)}`;return{from:e.from,to:null!=(u=e.token)?u:"",value:"0x0",data:b}}var y=(0,U.toBigIntHex)(d.shiftedBy(t.decimals));return{from:e.from,to:e.to,value:y,data:"0x"}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromBatchTransfer=function(){var e=(0,g.default)((function*(e){var t,n,r,a=e.transferInfos,o=e.prevNonce,i=yield this.getNetwork(),d=yield this.getDbAccount(),c=a[0],u=Boolean(c.token),s=c.nftTokenId,f=c.isNFT,l=c.nftType,p=void 0!==o?o+1:yield this.getNextNonce(i.id,d),b=J.batchTransferContractAddress[i.id];if(!b)throw new Error(`${i.name} has not deployed a batch transfer contract`);var v=new(D())(0);if(u)if(f&&l&&s)t=Y.BatchTransferSelectors.disperseNFT,n=["address","address[]","uint256[]","uint256[]"],r=[c.to].concat((0,h.default)(y()(a,(function(e,t){return e[0].push(t.token||""),e[1].push(t.nftTokenId||""),e[2].push(new(D())("erc1155"===t.nftType?t.amount:0).toFixed()),e}),[[],[],[]])));else{var m,g=yield this.engine.ensureTokenInDB(this.networkId,null!=(m=c.token)?m:"");if(!g)throw new Error(`Token not found: ${c.token}`);t=Y.BatchTransferSelectors.disperseTokenSimple,n=["address","address[]","uint256[]"],r=[g.tokenIdOnNetwork].concat((0,h.default)(y()(a,(function(e,t){var n=new(D())(t.amount);return e[0].push(t.to),e[1].push((0,U.toBigIntHex)(n.shiftedBy(g.decimals))),e}),[[],[]])))}else t=Y.BatchTransferSelectors.disperseEther,n=["address[]","uint256[]"],r=y()(a,(function(e,t){var n=new(D())(t.amount).shiftedBy(i.decimals);return v=v.plus(n),e[0].push(t.to),e[1].push(n.toFixed()),e}),[[],[]]);return{from:c.from,to:b,data:`${t}${E.defaultAbiCoder.encode(n,r).slice(2)}`,value:u?"0x0":(0,U.toBigIntHex)(v),nonce:String(p)}}));return function(t){return e.apply(this,arguments)}}(),r.isEarliestPendingTx=function(){var e=(0,g.default)((function*(e){var t,n=e.encodedTx,r=yield j.default.history.getMinPendingNonce({accountId:this.accountId,networkId:this.networkId});return new(D())(null!=(t=n.nonce)?t:0).isEqualTo(null!=r?r:0)}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromWrapperTokenDeposit=function(e){var t=e.amount,n=e.from,r=e.contract,a=re.WrapperTokenMethodSelectors.doposit,o=new(D())(t),i=(0,U.toBigIntHex)(o.shiftedBy(18));return{from:n,to:r,value:i,data:`${a}${E.defaultAbiCoder.encode(["uint256"],[i]).slice(2)}`}},r.buildEncodedTxFromWrapperTokenWithdraw=function(e){var t=e.amount,n=e.from,r=e.contract,a=re.WrapperTokenMethodSelectors.withdraw,o=new(D())(t),i=(0,U.toBigIntHex)(o.shiftedBy(18));return{from:n,to:r,value:"0x0",data:`${a}${E.defaultAbiCoder.encode(["uint256"],[i]).slice(2)}`}},r.buildEncodedTxFromApprove=function(){var e=(0,g.default)((function*(e,t){var n=yield Promise.all([this.getNetwork(),this.engine.ensureTokenInDB(this.networkId,e.token),this.validateAddress(e.spender),this.getDbAccount()]),r=(0,m.default)(n,4),a=r[0],o=r[1],i=r[2],d=r[3];if("undefined"===typeof o)throw new Error(`Token not found: ${e.token}`);var c=void 0!==t?t+1:yield this.getNextNonce(a.id,d),u=new(D())(e.amount),s=(0,U.toBigIntHex)(u.isNaN()?new(D())(2).pow(256).minus(1):u.shiftedBy(o.decimals)),f=`${re.Erc20MethodSelectors.tokenApprove}${E.defaultAbiCoder.encode(["address","uint256"],[i,s]).slice(2)}`;return{from:e.from,to:e.token,value:"0x0",data:f,nonce:String(c)}}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxsFromSetApproveForAll=function(){var e=(0,g.default)((function*(e,t){var n=yield this.getNetwork(),r=yield this.getDbAccount(),a=void 0!==t?t+1:yield this.getNextNonce(n.id,r),o=e.map((function(e,t){return{from:e.from,to:e.to,data:`${"erc1155"===e.type?re.Erc1155MethodSelectors.setApprovalForAll:re.Erc721MethodSelectors.setApprovalForAll}${E.defaultAbiCoder.encode(["address","bool"],[e.spender,e.approved]).slice(2)}`,value:"0x0",nonce:a+t}}));return Promise.resolve(o)}));return function(t,n){return e.apply(this,arguments)}}(),r.getReadProvider=function(){var e=(0,g.default)((function*(){var e=yield H.default.getModule(),t=yield this.getEthersProvider();if(t)return new e.MulticallProvider(t,{verbose:!0})}));return function(){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=(0,g.default)((function*(e){var t=e.owner,n=e.spender,r=e.token;try{var a,o=yield this.getReadProvider(),i=new C.Contract(r,Je,o),d=yield i.functions.allowance(t,n),c=String(yield d[0]),u=yield i.functions.totalSupply(),s=null==u||null==(a=u[0])||null==a.toString?void 0:a.toString();return{isUnlimited:new(D())(c).gt(new(D())(s)),allowance:c}}catch(f){return{isUnlimited:!1,allowance:0}}}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=(0,g.default)((function*(e){var t=e.owner,n=e.spender,r=e.token,a=e.type;try{var o=yield this.getReadProvider(),i=new C.Contract(r,"erc1155"===a?We:$e,o),d=yield i.functions.isApprovedForAll(t,n);return(0,m.default)(d,1)[0]}catch(c){return!1}}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=(0,g.default)((function*(e){return Promise.resolve(e.to===J.batchTransferContractAddress[this.networkId])}));return function(t){return e.apply(this,arguments)}}(),r.updateEncodedTx=function(){var e=(0,g.default)((function*(e,t,n){if(n.type===ee.IEncodedTxUpdateType.tokenApprove){var r=t;return this.updateEncodedTxTokenApprove(e,r.amount)}return n.type===ee.IEncodedTxUpdateType.transfer?this.updateEncodedTxTransfer(e,t):n.type===ee.IEncodedTxUpdateType.advancedSettings?this.updateEncodedTxAdvancedSettings(e,t):n.type===ee.IEncodedTxUpdateType.customData?this.updateEncodedTxCustomData(e,t):Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),r.updateEncodedTxCustomData=function(){var e=(0,g.default)((function*(e,t){return e.customData=t,Promise.resolve(e)}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxAdvancedSettings=function(){var e=(0,g.default)((function*(e,t){return this.settings.nonceEditable&&t.currentNonce&&(e.nonce=t.currentNonce),!this.settings.hexDataEditable||p()(t.currentHexData)||e.data&&"0x"!==e.data||e.data===t.currentHexData||(e.data=t.currentHexData),Promise.resolve(e)}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxTransfer=function(){var e=(0,g.default)((function*(e,t){var n=yield this.legacyDecodeTx(e),r=t.amount,a=new(D())(r);if(n.txType===ae.EVMDecodedTxType.NATIVE_TRANSFER){var o=yield this.getNetwork();e.value=(0,U.toBigIntHex)(a.dp(D().min(a.decimalPlaces()-2,o.decimals-2).toNumber(),D().ROUND_FLOOR).shiftedBy(o.decimals))}if(n.txType===ae.EVMDecodedTxType.TOKEN_TRANSFER){var i=n.info,d=(0,U.toBigIntHex)(a.shiftedBy(i.token.decimals)),c=`${re.Erc20MethodSelectors.tokenTransfer}${E.defaultAbiCoder.encode(["address","uint256"],[i.recipient,d]).slice(2)}`;e.data=c}return e}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxTokenApprove=function(){var e=(0,g.default)((function*(e,t){var n=re.Erc20MethodSelectors.tokenApprove,r=yield this.legacyDecodeTx(e);if(r.txType!==ae.EVMDecodedTxType.TOKEN_APPROVE)throw new Error("Not a approve transaction.");var a,o=r.info,i=o.token,d=o.spender;if(t===ae.InfiniteAmountText||t===ae.InfiniteAmountHex)a=ae.InfiniteAmountHex;else{var c=new(D())(t);if(c.isNaN())throw new Error(`Invalid amount input: ${t}`);a=(0,U.toBigIntHex)(c.shiftedBy(i.decimals))}var u=`${n}${E.defaultAbiCoder.encode(["address","uint256"],[d,a]).slice(2)}`;return Ue(Ue({},e),{},{data:u})}));return function(t,n){return e.apply(this,arguments)}}(),r.buildUnsignedTxFromEncodedTx=function(){var e=(0,g.default)((function*(e){var t=yield this.getNetwork(),n=yield this.getDbAccount(),r=e.from,a=e.to,o=e.value,i=e.data,d=e.customData,c=e.gas,u=e.gasLimit,s=e.gasPrice,l=e.maxFeePerGas,b=e.maxPriorityFeePerGas,y=e.nonce,h=(0,f.default)(e,Ke);L.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> encodedTx",e);var v=null!=u?u:c,m=new(D())(null!=y?y:"NaN"),g=m.isNaN()?yield this.getNextNonce(t.id,n):m.toNumber(),w=(0,z.fillUnsignedTxObj)({shiftFeeDecimals:!1,network:t,dbAccount:n,from:r,to:a,valueOnChain:o,extra:Ue({data:i,customData:d,feeLimit:p()(v)?void 0:new(D())(v),feePricePerUnit:p()(s)?void 0:new(D())(s),maxFeePerGas:l,maxPriorityFeePerGas:b,nonce:g},h)});L.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> fillUnsignedTx",w,ze(w));var T=yield this.engine.providerManager.buildUnsignedTx(this.networkId,w);return L.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> buildUnsignedTx",T,ze(T)),e.nonce=g,Ue(Ue({},T),{},{encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),r._toNormalAmount=function(e,t){var n=Ae.BigNumber.from(e);return Ae.utils.formatUnits(n,t)},r.fetchFeeInfo=function(){var e=(0,g.default)((function*(e){var t,n,r,a,o,i,d,c,u=Ue(Ue({},e),{},{nonce:1,gasPrice:"1"}),l=u.gas,b=u.gasLimit,y=(0,f.default)(u,Le),h=yield this.getNetwork(),v=yield this.engine.getGasInfo(this.networkId),m=v.prices,g=v.networkCongestion,w=v.estimatedTransactionCount;5===m.length&&(m=m.slice(1,4));var T=null==(t=this.settings.subNetworkSettings)?void 0:t[this.networkId];null!=T&&T.isIntegerGasPrice&&(m=m.map((function(e){return s()(e)?new(D())(e).toFixed(0):e})));var x,I=(yield this.decodeTxMemoizee(e)).actions;if(1===I.length&&(null==I||null==(n=I[0])?void 0:n.type)===ee.IDecodedTxActionType.NATIVE_TRANSFER)try{x=yield this.buildUnsignedTxFromEncodedTx(Ue(Ue({},y),{},{value:this.networkId===M.OnekeyNetwork.fevm?"0x1":"0x0"}))}catch(H){console.error(H)}if("undefined"===typeof x)try{x=yield this.buildUnsignedTxFromEncodedTx(y)}catch(K){throw L.default.common.error(K),K}var A="0";if(Ve.includes(this.networkId)){var P,k,N=Ae.utils.serializeTransaction({value:e.value,data:e.data,gasLimit:`0x${(null!=(P=null==(k=x)?void 0:k.feeLimit)?P:new(D())("0")).toString(16)}`,to:e.to,chainId:10,gasPrice:"0xf4240",nonce:1}),O=`0x49948e0e${E.defaultAbiCoder.encode(["bytes"],[N]).slice(2)}`,C=yield this.getJsonRPCClient(),F=yield C.rpc.call("eth_call",[{to:"0x420000000000000000000000000000000000000F",data:O},"latest"]);A=new(D())(F).shiftedBy(-h.feeDecimals).toFixed()}var S=Boolean((null==(r=m)?void 0:r.length)&&(null==(a=m)?void 0:a.every((function(e){return"object"===typeof e})))),B=D().max(null!=(o=null==(i=x)?void 0:i.feeLimit)?o:"0",null!=l?l:"0",null!=b?b:"0").toFixed(),R=p()(null==(d=x)?void 0:d.feeLimitForDisplay)?void 0:new(D())(null==(c=x)?void 0:c.feeLimitForDisplay).toFixed();return{nativeSymbol:h.symbol,nativeDecimals:h.decimals,feeSymbol:h.feeSymbol,feeDecimals:h.feeDecimals,eip1559:S,limit:B,limitForDisplay:R,prices:m,defaultPresetIndex:"1",baseFeeValue:A,extraInfo:{networkCongestion:g,estimatedTransactionCount:w}}}));return function(t){return e.apply(this,arguments)}}(),r.attachFeeInfoToEncodedTx=function(){var e=(0,g.default)((function*(e){var t=yield this.getNetwork(),n=e.encodedTx,r=e.feeInfoValue,a=Ue({},n);if(p()(r.limit)||(a.gas=(0,U.toBigIntHex)(new(D())(r.limit)),a.gasLimit=(0,U.toBigIntHex)(new(D())(r.limit))),r.eip1559){if(!p()(r.price1559)){var o,i,d=r.price1559;a.maxFeePerGas=(0,U.toBigIntHex)(new(D())(null!=(o=null==d?void 0:d.maxFeePerGas)?o:0).shiftedBy(t.feeDecimals)),a.maxPriorityFeePerGas=(0,U.toBigIntHex)(new(D())(null!=(i=null==d?void 0:d.maxPriorityFeePerGas)?i:0).shiftedBy(t.feeDecimals)),delete a.gasPrice}}else p()(r.price)||(a.gasPrice=(0,U.toBigIntHex)(new(D())(r.price).shiftedBy(t.feeDecimals)));return Promise.resolve(a)}));return function(t){return e.apply(this,arguments)}}(),r.mmGetPublicKey=function(){var e=(0,g.default)((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=e.password;if("undefined"===typeof r)throw new G.OneKeyInternalError("password required");var a=(yield n.getSigners(r,[t.address]))[t.address];return this.engineProvider.mmGetPublicKey(a)}throw new G.NotImplemented("Only software keryings support getting encryption key.")}));return function(t){return e.apply(this,arguments)}}(),r.mmDecrypt=function(){var e=(0,g.default)((function*(e,t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")||n.id.startsWith("imported")){var r=this.keyring,a=t.password;if("undefined"===typeof a)throw new G.OneKeyInternalError("password required");var o=(yield r.getSigners(a,[n.address]))[n.address];return this.engineProvider.mmDecrypt(e,o)}throw new G.NotImplemented("Only software keryings support mm decryption.")}));return function(t,n){return e.apply(this,arguments)}}(),r.personalECRecover=function(){var e=(0,g.default)((function*(e,t){return this.engineProvider.ecRecover({type:Q.ETHMessageTypes.PERSONAL_SIGN,message:e},t)}));return function(t,n){return e.apply(this,arguments)}}(),r.getTokenAllowance=function(){var e=(0,g.default)((function*(e,t){var n=yield Promise.all([this.getDbAccount(),this.engine.ensureTokenInDB(this.networkId,e)]),r=(0,m.default)(n,2),a=r[0],o=r[1];if("undefined"===typeof o)throw console.error(`Token not found: ${e}`),new Error;var i=`0xdd62ed3e${E.defaultAbiCoder.encode(["address","address"],[a.address,t]).slice(2)}`,d=yield this.getJsonRPCClient(),c=yield d.rpc.call("eth_call",[{to:o.tokenIdOnNetwork,data:i},"latest"]);return new(D())(c).shiftedBy(-o.decimals)}));return function(t,n){return e.apply(this,arguments)}}(),r.batchTokensAllowance=function(){var e=(0,g.default)((function*(e,t){for(var n=[],r=0;r<t.length;r+=1){var a=t[r],o=yield Promise.all([this.getDbAccount(),this.engine.ensureTokenInDB(this.networkId,e)]),i=(0,m.default)(o,2),d=i[0],c=i[1];if("undefined"===typeof c)throw console.error(`Token not found: ${e}`),new Error;var u=`0xdd62ed3e${E.defaultAbiCoder.encode(["address","address"],[d.address,a]).slice(2)}`;n.push({to:c.tokenIdOnNetwork,data:u})}var s=yield this.getJsonRPCClient();return(yield s.batchEthCall(n)).map((function(e){return Number(e)}))}));return function(t,n){return e.apply(this,arguments)}}(),r.getOutputAccount=function(){var e=(0,g.default)((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,displayAddress:Ae.utils.getAddress(e.address),template:e.template}}));return function(){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(e){return Promise.resolve(Ae.utils.getAddress(e))},r.getExportedCredential=function(){var e=(0,g.default)((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),a=(0,m.default)(r,1)[0];return`0x${(0,S.decrypt)(e,a).toString("hex")}`}throw new G.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),r.buildNativeTransferAction=function(){var e=(0,g.default)((function*(e){return{tokenInfo:yield this.engine.getNativeTokenInfo(this.networkId),from:e.fromAddress,to:e.toAddress,amount:e.amount,amountValue:e.value,extraInfo:null}}));return function(t){return e.apply(this,arguments)}}(),r.buildTokenTransferAction=function(){var e=(0,g.default)((function*(e){var t,n=yield this.getAccountAddress(),r=e.info;return{tokenInfo:r.token,from:null!=(t=r.from)?t:n,to:r.recipient,amount:r.amount,amountValue:r.value,extraInfo:null}}));return function(t){return e.apply(this,arguments)}}(),r.buildNFTTransferAcion=function(){var e=(0,g.default)((function*(e){return Promise.resolve({asset:e.asset,amount:e.amount,send:e.from,receive:e.to,extraInfo:null})}));return function(t){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=(0,g.default)((function*(e){var t=yield this.getJsonRPCClient();try{return yield t.rpc.call(e.method,e.params)}catch(n){throw(0,z.extractResponseError)(n)}}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){return new F.Geth(e)},r.fetchTokenInfos=function(e){return this.engine.providerManager.getTokenInfos(this.networkId,e)},r.getAccountNonce=function(){var e=(0,g.default)((function*(){return yield(0,oe.getTxCount)(yield this.getAccountAddress(),this)}));return function(){return e.apply(this,arguments)}}(),r.updatePendingTxs=function(){var e=(0,g.default)((function*(e){var t=ae.EVMTxDecoder.getDecoder(this.engine),n=e.filter((function(e){return"rawTx"in e})).filter((function(e){return e.status===q.HistoryEntryStatus.PENDING})).map(function(){var e=(0,g.default)((function*(e){return{entry:e,decodedItem:yield t.decodeHistoryEntry(e)}}));return function(t){return e.apply(this,arguments)}}());if(!n.length)return{};var r=yield Promise.all(n),a=yield this.getTransactionStatuses(r.map((function(e){return e.decodedItem.txHash}))),o=r[0].decodedItem.fromAddress,i=yield(0,oe.getTxCount)(o,this),d={};return a.forEach((function(e,t){var n=r[t],a=n.entry,o=n.decodedItem,c=a.id,u=o.nonce;e===B.TransactionStatus.NOT_FOUND||e===B.TransactionStatus.INVALID?!p()(u)&&u<i&&(d[c]=q.HistoryEntryStatus.DROPPED):e===B.TransactionStatus.CONFIRM_AND_SUCCESS?d[c]=q.HistoryEntryStatus.SUCCESS:e===B.TransactionStatus.CONFIRM_BUT_FAILED&&(d[c]=q.HistoryEntryStatus.FAILED)})),Object.keys(d).length>0&&(yield this.engine.dbApi.updateHistoryEntryStatuses(d)),d}));return function(t){return e.apply(this,arguments)}}(),r.mergeDecodedTx=function(){var e=(0,g.default)((function*(e){var t,n=e.decodedTx,r=(e.encodedTx,e.historyTx),a=(e.rawTx,e.covalentTx),o=(e.rpcReceiptTx,e.nftTxs),i=e.isCovalentApiAvailable,d=yield this.getNetwork();r&&(n=Ue(Ue({},r.decodedTx),{},{encodedTx:null!=(t=n.encodedTx)?t:r.decodedTx.encodedTx}));if(a){var c,u,s=new Date(a.block_signed_at).getTime();n.updatedAt=s,n.createdAt=null!=(c=n.createdAt)?c:s,n.status=a.successful?ee.IDecodedTxStatus.Confirmed:ee.IDecodedTxStatus.Failed,n.signer=a.from_address||n.signer,n.outputActions=(null==(u=a.parsedDecodedTx)?void 0:u.outputActions)||n.outputActions;var f=new(D())(a.gas_price).toFixed(),l=(0,te.convertFeeValueToGwei)({value:f,network:d}),p=new(D())(a.gas_offered).toFixed(),b=new(D())(a.gas_spent).toFixed(),y={priceValue:f,price:l,limit:p,limitUsed:b};if(n.feeInfo=n.feeInfo||y,n&&n.feeInfo&&(n.feeInfo.limitUsed=b,n.feeInfo.limit=p,n.feeInfo.eip1559)){var h=n.feeInfo.price1559;h.gasPrice=l,h.gasPriceValue=f}n.isFinal=!0}n.status!==ee.IDecodedTxStatus.Pending&&(i||n.createdAt&&Date.now()-n.createdAt>K.HISTORY_CONSTS.SET_IS_FINAL_EXPIRED_IN&&(n.isFinal=!0));var v=yield this.getAccountAddress();return n=this.mergeNFTTx({address:v,decodedTx:n,nftTxs:o}),Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.mergeNFTTx=function(e){var t=e.address,n=e.decodedTx,r=e.nftTxs;if(r){var a,o=r.map((function(e){return(0,W.createOutputActionFromNFTTransaction)({transaction:e,address:t})})).filter(Boolean),i=null!=(a=n.outputActions)?a:[],d=null==i?void 0:i.filter((function(e){var t=e.tokenTransfer,n=e.tokenApprove,a=e.nftTransfer;if(t||n||a){var o,i=null!=(o=null==t?void 0:t.tokenInfo)?o:null==n?void 0:n.tokenInfo,d=null==a?void 0:a.asset;if(i){var c=i.tokenIdOnNetwork,u=i.id;if(r.find((function(e){return e.contractAddress===c&&e.tokenId===u})))return!1}if(d)if(r.find((function(e){return(e.contractAddress===d.contractAddress||e.tokenAddress===d.tokenAddress)&&(e.tokenId===d.tokenId||e.contractTokenId===d.contractTokenId)})))return!1}return!0}));n.outputActions=[].concat((0,h.default)(d),(0,h.default)(o))}return n},r.fetchOnChainHistory=function(){var e=(0,g.default)((function*(e){var t=this,n=e.tokenIdOnNetwork,r=e.localHistory,a=void 0===r?[]:r,o=a.filter((function(e){return e.decodedTx.isFinal})).map((function(e){return e.decodedTx.txid})),i=yield this.getNetworkChainId(),d=yield this.getAccountAddress(),u=yield this.getJsonRPCClient(),f=[],l=[],p=!1;try{var b=yield V.fetchCovalentHistoryRaw({chainId:i,address:d,contract:n});p=!0,f=(l=b.data.items).map((function(e){return e.tx_hash}))}catch(w){console.error(w),f=a.filter((function(e){return!!e.isLocalCreated})).map((function(e){return e.decodedTx.txid}))}var y=(f=(f=c()(f,o)).filter(Boolean)).map((function(e){return["eth_getTransactionByHash",[e]]})),h=[];if(y.length)try{h=yield u.rpc.batchCall(y)}catch(w){console.error(w)}var v=yield(0,W.getNFTTransactionHistory)(d,this.networkId),m=yield Promise.all(f.map(function(){var e=(0,g.default)((function*(e,r){var o,i,c,u,f=h.find((function(t){return(null==t?void 0:t.hash)===e})),b=Boolean(f);f&&b&&f.input&&!f.data&&(f.data=f.input);var y,m=a.find((function(t){return t.decodedTx.txid===e}));if(null!=m&&null!=(o=m.decodedTx)&&o.isFinal)return null;(f=f||(null==m||null==(i=m.decodedTx)?void 0:i.encodedTx))&&(s()(f.nonce)&&(f.nonce=null!=(y=new(D())(f.nonce).toNumber())?y:0));var g=l.find((function(t){return t.tx_hash===e}));g&&(g=yield V.parseCovalentTxToDecodedTx({covalentTx:g,address:d,vault:t,encodedTx:f}));var T=null==(c=g)?void 0:c.parsedDecodedTx;if(!T&&null!=(u=g)&&u.onlyInvolvedInDelegateVotesChanged)return null;if(f)try{T=yield t.decodeTx(f,null)}catch(w){console.error(w)}if(!T)return null;var x=v[e];return(T=yield t.mergeDecodedTx({decodedTx:T,encodedTx:f,historyTx:m,covalentTx:g,nftTxs:x,isCovalentApiAvailable:p})).tokenIdOnNetwork=n,t.buildHistoryTx({decodedTx:T,encodedTx:f,historyTxToMerge:m})}));return function(t,n){return e.apply(this,arguments)}}()));return m.filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.checkIsScamHistoryTx=function(){var e=(0,g.default)((function*(e){try{var t,n=e.decodedTx,r=n.encodedTx,a=null==r?void 0:r.from.toLowerCase(),o=null==r||null==(t=r.to)?void 0:t.toLowerCase(),i=(yield this.getAccountAddress()).toLocaleLowerCase();if(a===i||o===i)return!1;for(var d=n.outputActions||n.actions,c=0;c<d.length;c+=1){var u,s,f,l,p=d[c];if(p.type!==ee.IDecodedTxActionType.TOKEN_TRANSFER)return!1;if(p.type===ee.IDecodedTxActionType.TOKEN_TRANSFER&&null!=(u=p.tokenTransfer)&&u.amount&&!new(D())(null==(s=p.tokenTransfer)?void 0:s.amount).isZero()){var b,y=yield this.getNetworkImpl(),h=null!=(b=K.UNIQUE_TOKEN_SYMBOLS[y])?b:[],v=p.tokenTransfer.tokenInfo;return!!(h.includes(v.symbol.toUpperCase())&&v.riskLevel&&v.riskLevel>Z.TokenRiskLevel.WARN)}if(p.type===ee.IDecodedTxActionType.TOKEN_TRANSFER&&null!=(f=p.tokenTransfer)&&f.amount&&new(D())(null==(l=p.tokenTransfer)?void 0:l.amount).isZero()&&[p.tokenTransfer.from.toLocaleLowerCase(),p.tokenTransfer.to.toLocaleLowerCase()].includes(a))return!1}return!0}catch(m){return!1}}));return function(t){return e.apply(this,arguments)}}(),r.fixAddressCase=function(e){return Promise.resolve(i()(e||""))},r.getAccountNameInfoMap=function(){var e=(0,g.default)((function*(){var e=yield this.getNetwork(),t=(0,$.getAccountNameInfoByImpl)(e.impl);return e.id!==M.OnekeyNetwork.etc&&(t=a()(t,"etcNative")),t}));return function(){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=(0,g.default)((function*(e){var t=e.accounts;return e.networkId!==M.OnekeyNetwork.etc?t.filter((function(e){return e.coinType!==K.COINTYPE_ETC})):Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(e){var t=e.previousNetwork,n=e.newNetwork,r=e.activeAccountId,a=(null==t?void 0:t.id)===M.OnekeyNetwork.etc,o=(null==n?void 0:n.id)===M.OnekeyNetwork.etc,i=(null==n?void 0:n.impl)===K.IMPL_EVM&&!o,d=(null==t?void 0:t.impl)===K.IMPL_EVM&&!a,c=null==r?void 0:r.indexOf("m/44'/61'/0'/"),u=a&&i&&!!c;return Promise.resolve({shouldChangeActiveAccount:u,shouldReloadAccountList:!u&&(o&&d)})},r.canAutoCreateNextAccount=function(){var e=(0,g.default)((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=(0,g.default)((function*(e){var t,r=yield this.getJsonRPCClient(),a=performance.now();try{var o=yield r.rpc.batchCall([["eth_blockNumber",[]],["eth_getBalance",["0xf44371ccc370662734cfc4b78b1beadf7012bc5d","latest"]],["eth_gasPrice",[]]],void 0,void 0,!0,!1),i=new(D())(o[0]).toNumber();if(Number.isNaN(i)||"string"!==typeof o[1]||"string"!==typeof o[2])throw new Error(`[evm.getClientEndpointStatus] Invalid response ${JSON.stringify(o)}`);t={rpcBatchSupported:!0,responseTime:Math.floor(performance.now()-a),latestBlock:i}}catch(d){(t=yield(0,T.default)((0,A.default)(n.prototype),"getClientEndpointStatus",this).call(this,e)).rpcBatchSupported=!1}return t}));return function(t){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=(0,g.default)((function*(e){var t=yield this.engine.providerManager.getEVMChainId(e);return String(t)}));return function(t){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=(0,g.default)((function*(e){var t=e.serviceData;return Promise.resolve({type:X.NFTAssetType.EVM,data:t})}));return function(t){return e.apply(this,arguments)}}(),(0,w.default)(n)}(ne.VaultBase)},565147:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringBase:()=>u,KeyringBaseMock:()=>s});var r=n(634795),a=n(887371),o=n(545754),i=n(411987),d=n(695058);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var u=function(e){(0,o.default)(n,e);var t=c(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=(0,r.default)((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(n)}(n(114540).VaultContext),s=function(e){(0,o.default)(n,e);var t=c(n);function n(){return t.apply(this,arguments)}return(0,a.default)(n)}(u)},82406:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringHardwareBase:()=>f});var r=n(634795),a=n(887371),o=n(545754),i=n(411987),d=n(695058),c=n(799075),u=n(814817);function s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var f=function(e){(0,o.default)(i,e);var t=s(i);function i(){return t.apply(this,arguments)}var d=i.prototype;return d.getHardwareInfo=function(){var e=(0,r.default)((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),d.getWalletPassphraseState=function(){var e=(0,r.default)((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!(0,u.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),d.getHardwareSDKInstance=function(){var e=(0,r.default)((function*(){var e,t,r,a,o;return null!=(o=yield null==(e=n.g)||null==(t=e.$backgroundApiProxy)||null==(r=t.backgroundApi)||null==(a=r.serviceHardware)||null==a.getSDKInstance?void 0:a.getSDKInstance())?o:c.HardwareSDK}));return function(){return e.apply(this,arguments)}}(),d.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,a.default)(i)}(n(565147).KeyringBase)},810887:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringHdBase:()=>b});var r=n(256666),a=n(634795),o=n(887371),i=n(545754),d=n(411987),c=n(695058),u=n(605851),s=n(940915);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var a=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}var b=function(e){(0,i.default)(n,e);var t=p(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=(0,a.default)((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],a=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new s.OneKeyInternalError("Unable to get credential.");var i=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return(0,u.batchGetPrivateKeys)(i,o,e,a,r).reduce((function(e,t){var n;return l(l({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,o.default)(n)}(n(280306).KeyringSoftwareBase)},255942:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringImportedBase:()=>s});var r=n(634795),a=n(887371),o=n(545754),i=n(411987),d=n(695058),c=n(940915);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var s=function(e){(0,o.default)(n,e);var t=u(n);function n(){return t.apply(this,arguments)}var i=n.prototype;return i.getPrivateKeys=function(){var e=(0,r.default)((function*(e,t){if("undefined"!==typeof t)throw new c.NotImplemented("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new c.OneKeyInternalError("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),i.getAddress=function(){throw new Error("Method not implemented.")},i.batchGetAddress=function(){throw new Error("Method not implemented.")},i.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,a.default)(n)}(n(280306).KeyringSoftwareBase)},280306:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringSoftwareBase:()=>y});var r=n(196234),a=n(256666),o=n(634795),i=n(887371),d=n(545754),c=n(411987),u=n(695058),s=n(292147),f=n(940915);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var y=function(e){(0,d.default)(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var a=n.prototype;return a.signTransaction=function(){var e=(0,o.default)((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new f.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return s.default.engine.info("signTransaction",this.networkId,e),p(p({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),a.signMessage=function(){var e=(0,o.default)((function*(e,t){var n=this,a=t.password;if("undefined"===typeof a)throw new f.OneKeyInternalError("Software signing requires a password.");var o=yield this.getDbAccount(),i=Object.values(yield this.getSigners(a,[o.address])),d=(0,r.default)(i,1)[0];return s.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,d)})))}));return function(t,n){return e.apply(this,arguments)}}(),a.getAddress=function(){throw new Error("Method not implemented.")},a.batchGetAddress=function(){throw new Error("Method not implemented.")},a.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,i.default)(n)}(n(565147).KeyringBase)},701625:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyringWatchingBase:()=>s});var r=n(634795),a=n(887371),o=n(545754),i=n(411987),d=n(695058),c=n(940915);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var s=function(e){(0,o.default)(n,e);var t=u(n);function n(){return t.apply(this,arguments)}var i=n.prototype;return i.signTransaction=function(){var e=(0,r.default)((function*(e,t){throw new c.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),i.signMessage=function(){var e=(0,r.default)((function*(e,t){throw new c.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),i.getAddress=function(){throw new Error("Method not implemented.")},i.batchGetAddress=function(){throw new Error("Method not implemented.")},i.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,a.default)(n)}(n(565147).KeyringBase)},153546:(e,t,n)=>{"use strict";n.r(t),n.d(t,{convertDeviceError:()=>d});var r=n(703599),a=n(302478),o=n(292147);n(213208);function i(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new a.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new a.BridgeNetworkError({message:t}):null}function d(e){var t,n=e||{},d=n.code,c=n.error,u=n.message,s=null!=(t=null!=c?c:u)?t:"Unknown error";if(i(d,s))return i(d,s);switch(o.default.hardwareSDK.info("Device Utils Convert Device Error:",d,s),d){case r.HardwareErrorCode.UnknownError:return new a.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceFwException:return new a.FirmwareVersionTooLow(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof s&&-1!==s.indexOf("ui-device_bootloader_mode")?new a.NotInBootLoaderMode(e):new a.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new a.DeviceNotSame(e);case r.HardwareErrorCode.DeviceNotFound:return new a.DeviceNotFind(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new a.NotInBootLoaderMode(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new a.UserCancelFromOutside(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new a.NotSupportPassphraseError(e);case r.HardwareErrorCode.IFrameLoadFail:return new a.InitIframeLoadFail(e);case r.HardwareErrorCode.IframeTimeout:return new a.InitIframeTimeout(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new a.FirmwareDownloadFailed(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new a.FirmwareUpdateManuallyEnterBoot(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new a.FirmwareUpdateAutoEnterBootFailure(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new a.FirmwareUpdateLimitOneDevice(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new a.FirmwareVersionTooLow(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new a.NewFirmwareUnRelease(e);case r.HardwareErrorCode.NewFirmwareForceUpdate:return new a.NewFirmwareForceUpdate(e);case r.HardwareErrorCode.NetworkError:return new a.NetworkError(e);case r.HardwareErrorCode.BlePermissionError:return new a.NeedBluetoothTurnedOn(e);case r.HardwareErrorCode.BleLocationError:return new a.NeedBluetoothPermissions({message:s});case r.HardwareErrorCode.BleLocationServicesDisabled:return new a.BleLocationServiceError({message:s});case r.HardwareErrorCode.BleDeviceNotBonded:return new a.DeviceNotBonded(e);case r.HardwareErrorCode.BleDeviceBondError:return new a.DeviceBondError(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new a.BleWriteCharacteristicError(e);case r.HardwareErrorCode.BleScanError:return new a.BleScanError({message:s});case r.HardwareErrorCode.BleAlreadyConnected:return new a.BleAlreadyConnectedError(e);case r.HardwareErrorCode.RuntimeError:return-1!==s.indexOf("EIP712 blind sign is disabled")?new a.OpenBlindSign(e):-1!==s.indexOf("Unknown message")||-1!==s.indexOf("Failure_UnexpectedMessage")?new a.UnknownMethod(e):new a.UnknownHardwareError(e);case r.HardwareErrorCode.PinInvalid:return new a.InvalidPIN(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new a.InvalidPassphrase(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new a.DeviceOpenedPassphrase(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new a.DeviceNotOpenedPassphrase(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new a.UserCancel(e);case r.HardwareErrorCode.BridgeNotInstalled:case a.CustomOneKeyHardwareError.NeedOneKeyBridge:return new a.NeedOneKeyBridge(e);case r.HardwareErrorCode.BridgeNetworkError:return new a.BridgeNetworkError(e);case r.HardwareErrorCode.BridgeTimeoutError:return new a.BridgeTimeoutError(e);case r.HardwareErrorCode.PollingTimeout:return new a.ConnectTimeoutError(e);case r.HardwareErrorCode.PollingStop:return new a.ConnectPollingStopError(e);case r.HardwareErrorCode.BlindSignDisabled:return new a.OpenBlindSign(e);case r.HardwareErrorCode.FileAlreadyExists:return new a.FileAlreadyExistError(e);case r.HardwareErrorCode.CheckDownloadFileError:return new a.IncompleteFileError(e);case r.HardwareErrorCode.NotInSigningMode:return new a.NotInSigningModeError(e);case r.HardwareErrorCode.DataOverload:return new a.DeviceDataOverload(e);default:return new a.UnknownHardwareError(e)}}},781207:e=>{e.exports=function(e,t,n,r){var a=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++a]);++a<o;)n=t(n,e[a],a,e);return n}},305877:e=>{e.exports=function(e,t,n,r,a){return a(e,(function(e,a,o){n=r?(r=!1,e):t(n,e,a,o)})),n}},317335:(e,t,n)=>{var r=n(585246),a=n(62034),o=n(636060),i=n(93746),d=o((function(e,t){return i(e)?r(e,a(t,1,i,!0)):[]}));e.exports=d},158215:(e,t,n)=>{var r=n(781207),a=n(224303),o=n(668286),i=n(305877),d=n(986152);e.exports=function(e,t,n){var c=d(e)?r:i,u=arguments.length<3;return c(e,o(t,4),n,u,a)}}}]);