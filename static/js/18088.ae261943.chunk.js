(self.webpackChunkweb=self.webpackChunkweb||[]).push([[18088],{786141:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VaultBase:()=>B,VaultBaseChainOnly:()=>D});var n=r(72579),o=r.n(n),i=r(256666),a=r(301842),u=r.n(a),s=r(634795),c=r(887371),d=r(545754),l=r(411987),f=r(695058),p=r(206391),h=r.n(p),y=r(636393),v=r(613549),w=r(292147),g=r(213208),m=r(992431),x=r(940915),I=r(278489),E=r(969618),A=r(398514),T=r(114540),b=r(348834).Buffer;function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}if(g.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var D=function(e){(0,d.default)(r,e);var t=P(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.initProvider=function(){var e=(0,s.default)((function*(){var e=(yield this.getNetwork()).impl;u()(E.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new x.NotImplemented},n.getEthersProvider=function(){var e=(0,s.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=(0,s.default)((function*(e){var t=this.createClientFromURL(e),r=performance.now(),n=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.checkRpcBatchSupport=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getDisplayAddress=function(){var e=(0,s.default)((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=(0,s.default)((function*(e){var t=yield this.engineProvider.verifyAddress(e),r=t.normalizedAddress;if(!t.isValid||!r)throw new x.InvalidAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=(0,s.default)((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=(0,s.default)((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new x.InvalidTokenAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=(0,s.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=(0,s.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=(0,s.default)((function*(e,t,r){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,r=e.tokenAddress;return{address:t,coin:_({},"string"===typeof r?{tokenAddress:r}:{})}})))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=(0,s.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return 0}));return function(){return e.apply(this,arguments)}}(),n.isEarliestPendingTx=function(){var e=(0,s.default)((function*(e){e.encodedTx;return!0}));return function(t){return e.apply(this,arguments)}}(),n.fetchBalanceDetails=function(){var e=(0,s.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=(0,s.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=(0,s.default)((function*(){var e=yield this.getNetwork();return(0,I.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=(0,s.default)((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=(0,s.default)((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=(0,s.default)((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=(0,s.default)((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),n.checkIsUnlimitedAllowance=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsApprovedForAll=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsBatchTransfer=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getFeePricePerUnit=function(){var e=(0,s.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.fetchRpcChainId=function(){var e=(0,s.default)((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),n.getTxWaitingSeconds=function(){var e=(0,s.default)((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),n.getUserNFTAssets=function(){var e=(0,s.default)((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),n.getTransactionDetail=function(){var e=(0,s.default)((function*(e){return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),(0,c.default)(r)}(T.VaultContext),B=function(e){(0,d.default)(r,e);var t=P(r);function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).uuid=y.default.v4().toString(),e}var n=r.prototype;return n.init=function(){var e=(0,s.default)((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),n.initKeyring=function(){var e=(0,s.default)((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=(0,s.default)((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.signAndSendTransaction=function(){var e=(0,s.default)((function*(e,t,r){var n=yield this.signTransaction(e,t);return r?_(_({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(_(_({},n),{},{encodedTx:e.encodedTx}))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=(0,s.default)((function*(e,t){w.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return w.default.engine.info("broadcastTransaction END:",{txid:r,rawTx:e.rawTx}),_(_({},e),{},{txid:r,encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.buildEncodedTxFromBatchTransfer=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.buildEncodedTxsFromSetApproveForAll=function(){var e=(0,s.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.activateAccount=function(){var e=(0,s.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.activateToken=function(){var e=(0,s.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.getTokenAllowance=function(){var e=(0,s.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.batchTokensAllowance=function(){var e=(0,s.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.getOutputAccount=function(){var e=(0,s.default)((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),n.getAccountBalance=function(){var e=(0,s.default)((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=(yield this.getDbAccount()).address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),r,n)}));return function(t){return e.apply(this,arguments)}}(),n.updatePendingTxs=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNonce=function(){var e=(0,s.default)((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),n.fixActionDirection=function(){var e=(0,s.default)((function*(e){var t,r,n,o,i=e.action,a=e.accountAddress;(i.direction=A.IDecodedTxDirection.OTHER,i.type===A.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(r=i.nativeTransfer)?void 0:r.to)||"",address:a}));i.type===A.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.tokenTransfer)?void 0:n.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),n.fixDecodedTx=function(){var e=(0,s.default)((function*(e){var t,r;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var n=null==(r=e.encodedTx)?void 0:r.nonce;e.nonce=u()(n)?e.nonce:new(h())(n).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var s=0;s<e.outputActions.length;s+=1){var c=e.outputActions[s];yield this.fixActionDirection({action:c,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.fixHistoryTx=function(){var e=(0,s.default)((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.buildHistoryTx=function(){var e=(0,s.default)((function*(e){var t=e.historyTxToMerge,r=(e.encodedTx,e.decodedTx),n=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==r?void 0:r.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();r.txid=a||r.txid,r.owner=u,o&&(r.signer=u),null!=n&&n.txKey&&(r.extraInfo?r.extraInfo.txKey=n.txKey:r.extraInfo={txKey:n.txKey});var s=_(_({id:`${this.networkId}_${a}_${this.accountId}`,isLocalCreated:Boolean(i)},t),{},{decodedTx:r});return s=yield this.fixHistoryTx(s),Promise.resolve(s)}));return function(t){return e.apply(this,arguments)}}(),n.checkIsScamHistoryTx=function(){var e=(0,s.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.fetchOnChainHistory=function(){var e=(0,s.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.fixAddressCase=function(e){return Promise.resolve(e)},n.buildTxActionDirection=function(){var e=(0,s.default)((function*(e){var t=e.from,r=e.to,n=e.address;return t=yield this.fixAddressCase(t||""),r=yield this.fixAddressCase(r),n=yield this.fixAddressCase(n),t===r&&t===n?A.IDecodedTxDirection.SELF:t&&t===n?A.IDecodedTxDirection.OUT:r&&r===n?A.IDecodedTxDirection.IN:A.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),n.getNextNonce=function(){var e=(0,s.default)((function*(e,t){var r,n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce;if(u()(n))throw new x.OneKeyError("Get on-chain nonce failed.");yield this.engine.getHistory(e,t.id,void 0,!1);var o=yield m.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e}),i=yield m.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),a=Math.max(u()(o)?0:o+1,n);if(Number.isNaN(a)&&(a=n),a>n)for(var s=n;s<a;s+=1)if(!i.includes(s)){a=s;break}if(a<n&&(a=n),a-n>=v.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new x.PendingQueueTooLong(v.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return a}));return function(t,r){return e.apply(this,arguments)}}(),n.validateSendAmount=function(e,t,r){return Promise.resolve(!0)},n.notifyChainChanged=function(e,t){},n.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},n.getPrivateKeyByCredential=function(e){return Promise.resolve(b.from(e.startsWith("0x")?e.slice(2):e,"hex"))},n.getMinDepositAmount=function(){var e=(0,s.default)((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),n.specialCheckEncodedTx=function(){var e=(0,s.default)((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),n.getAllUsedAddress=function(){var e=(0,s.default)((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),n.attachFeeInfoToDAppEncodedTx=function(){var e=(0,s.default)((function*(e){return Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),(0,c.default)(r)}(D)},818088:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ue});var n,o,i=r(256666),a=r(634795),u=r(887371),s=r(545754),c=r(411987),d=r(695058),l=r(206391),f=r.n(l),p=r(776553),h=r(292147),y=r(396564),v=r(992431),w=r(940915),g=r(398514),m=r(16280),x=r(786141),I=r(789644),E=r.n(I),A=r(764550),T=r(85397),b=r(740727);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}!function(e){e.GET_TRANSACTIONS_BY_ADDRESS="gettransactionsbyaddress",e.GET_BALANCE_OF_ADDRESS="getbalanceofaddress",e.GET_TRANSACTION="gettransaction",e.GET_BLOCK_COUNT="getblockcount",e.VALIDATE_ADDRESS="validateaddress"}(n||(n={})),function(e){e.BASE64="base64",e.JSON_PARSED="jsonParsed"}(o||(o={}));var _=function(e){(0,s.default)(r,e);var t=O(r);function r(e){var r;return(r=t.call(this)).baseURL=e,r.rpc=new T.JsonRPCRequest(`${e}/json_rpc`),r}var o=r.prototype;return o.checkDynexNodeResponse=function(e){var t=e.resp,r=e.method;if(!t||!t.status||"ok"!==t.status.toLowerCase())throw new Error(`${r}: Failed to get response from Dynex node`)},o.getBlockCount=function(){var e=(0,a.default)((function*(){return(yield this.rpc.call(n.GET_BLOCK_COUNT,[])).count}));return function(){return e.apply(this,arguments)}}(),o.getBalanceOfAddress=function(){var e=(0,a.default)((function*(e){var t,r=yield this.rpc.call(n.GET_BALANCE_OF_ADDRESS,{address:e});try{this.checkDynexNodeResponse({resp:r,method:"getBalanceOfAddress"})}catch(o){return new(f())(0)}return new(f())(null!=(t=r.balance.balance)?t:0)}));return function(t){return e.apply(this,arguments)}}(),o.validateAddress=function(){var e=(0,a.default)((function*(e){var t=yield this.rpc.call(n.VALIDATE_ADDRESS,{address:e});try{this.checkDynexNodeResponse({resp:t,method:"validateAddress"})}catch(r){return!1}return t.isvalid}));return function(t){return e.apply(this,arguments)}}(),o.getNodeInfo=function(){var e=(0,a.default)((function*(){return(yield E().get(`${this.baseURL}/getinfo`)).data}));return function(){return e.apply(this,arguments)}}(),o.getTransaction=function(){var e=(0,a.default)((function*(e){var t=yield this.rpc.call(n.GET_TRANSACTION,{hash:e});return this.checkDynexNodeResponse({resp:t,method:"getTransaction"}),t.transaction}));return function(t){return e.apply(this,arguments)}}(),o.getTransactionStatus=function(){var e=(0,a.default)((function*(e){try{return(yield this.getTransaction(e)).inBlockchain?b.TransactionStatus.CONFIRM_AND_SUCCESS:b.TransactionStatus.PENDING}catch(t){return b.TransactionStatus.PENDING}}));return function(t){return e.apply(this,arguments)}}(),o.getTransactionsByAddress=function(){var e=(0,a.default)((function*(e){var t=yield this.rpc.call(n.GET_TRANSACTIONS_BY_ADDRESS,{address:e});return this.checkDynexNodeResponse({resp:t,method:"getTransactionsByAddress"}),t.transactions}));return function(t){return e.apply(this,arguments)}}(),o.getInfo=function(){throw new w.NotImplemented},o.getAddresses=function(){throw new w.NotImplemented},o.getFeePricePerUnit=function(){throw new w.NotImplemented},o.broadcastTransaction=function(){var e=(0,a.default)((function*(e){var t=yield E().post(`${this.baseURL}/sendrawtransaction`,{tx_as_hex:e,do_not_relay:!1});if(!t.data.status||"OK"!==t.data.status)throw new Error("Failed to send transaction");return t.data.status}));return function(t){return e.apply(this,arguments)}}(),o.getBalances=function(){throw new w.NotImplemented},o.getTransactionStatuses=function(){throw new w.NotImplemented},(0,u.default)(r)}(A.BaseClient),P=r(301842),D=r.n(P),B=r(703599),N=r(153546),C=r(613549),S=r(997293),R=r(278489),k=r(398145),H=r(82406),F=r(368652),M=r(59256),U=r(243868),K=185,j=29,$=52;function L(e){for(var t=new U.BigInteger(e),r="";t.compare(128)>=0;)r+=`0${(127&t.lowVal()|128).toString(16)}`.slice(-2),t=t.divide(new U.BigInteger(2).pow(7));return r+=`0${t.toJSValue().toString(16)}`.slice(-2)}function G(e){if(e.length%2!==0||(t=e,!new RegExp(`[0-9a-fA-F]{${t.length}}`).test(t)))throw new Error("Input invalid");var t;return(0,M.keccak256)(function(e){if(e.length%2!==0)throw new Error("Hex string has invalid length!");for(var t=new Uint8Array(e.length/2),r=0;r<e.length/2;r+=1)t[r]=parseInt(e.slice(2*r,2*r+2),16);return t}(e))}function V(e){for(var t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",r=[],n=0;n<58;n+=1)r.push(t.charCodeAt(n));var o=[0,2,3,5,6,7,9,10,11],i=r.length,a=11,u=new(f())(2).pow(64),s=function(e,t,n){if(e.length<1||e.length>a)throw new Error(`Invalid block length: ${e.length}`);var s=o.indexOf(e.length);if(s<=0)throw new Error("Invalid block size");for(var c=new(f())(0),d=new(f())(1),l=e.length-1;l>=0;l-=1){var p=r.indexOf(e[l]);if(p<0)throw new Error("Invalid symbol");var h=d.multipliedBy(p).plus(c);if(1===h.comparedTo(u))throw new Error("Overflow");c=h,d=d.multipliedBy(i)}if(s<8&&new(f())(2).pow(8*s).comparedTo(c)<=0)throw new Error("Overflow 2");return t.set(function(e,t){var r=new(f())(e),n=new Uint8Array(t);if(t<1||t>8)throw new Error("Invalid input length");for(var o=new(f())(2).pow(8),i=t-1;i>=0;i-=1)n[i]=r.mod(o).toNumber(),r=r.dividedToIntegerBy(o);return n}(c,s),n),t},c=function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t}(e);if(0===c.length)return"";var d=Math.floor(c.length/a),l=c.length%a,p=o.indexOf(l);if(p<0)throw new Error("Invalid encoded length");for(var h=new Uint8Array(8*d+p),y=0;y<d;y+=1)s(c.subarray(y*a,y*a+a),h,8*y);return l>0&&s(c.subarray(d*a,d*a+l),h,8*d),function(e){for(var t=[],r=0;r<e.length;r+=1)t.push(`0${e[r].toString(16)}`.slice(-2));return t.join("")}(h)}function W(e){var t=V(e),r=L(K),n=L(j),o=L($),i=t.slice(0,r.length);if(i!==r&&i!==n&&i!==o)throw new Error("Invalid address prefix");return{spend:(t=t.slice(r.length)).slice(0,64),view:t.slice(64,128)}}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var Y=function(e){(0,s.default)(r,e);var t=X(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.prepareAccounts=function(){var e=(0,a.default)((function*(e){var t,r=e.indexes,n=e.names,o=e.template,i=(0,S.slicePathTemplate)(o).pathPrefix,a=r.map((function(e){return`${i}/${e}'`})),u=yield this.getHardwareSDKInstance(),s=yield this.getHardwareInfo(),c=s.connectId,d=s.deviceId,l=yield this.getWalletPassphraseState(),f=(0,R.getAccountNameInfoByImpl)(C.IMPL_DYNEX).default.prefix;try{t=yield u.dnxGetAddress(c,d,z({bundle:a.map((function(e){return{path:e,showOnOneKey:false}}))},l))}catch(E){throw h.default.common.error(E),new w.OneKeyHardwareError(E)}if(!t.success)throw h.default.common.error(t.payload),(0,N.convertDeviceError)(t.payload);var p=[],y=0;for(var v of t.payload){var g,m=v.address,x=v.path;if(D()(m))throw new w.OneKeyHardwareError({message:"Get Dynex Address error."});var I=(n||[])[y]||`${f} #${r[y]+1}`;p.push({id:`${this.walletId}--${x}`,name:I,type:k.AccountType.UTXO,path:x,coinType:C.COINTYPE_DYNEX,pub:"",xpub:"",address:m,addresses:(g={},g["0/0"]=m,g)}),y+=1}return p}));return function(t){return e.apply(this,arguments)}}(),n.getAddress=function(){var e=(0,a.default)((function*(e){var t,r=yield this.getHardwareSDKInstance(),n=yield this.getHardwareInfo(),o=n.connectId,i=n.deviceId,a=yield this.getWalletPassphraseState(),u=yield r.dnxGetAddress(o,i,z({path:e.path,showOnOneKey:e.showOnOneKey},a));if(u.success&&null!=(t=u.payload)&&t.address)return u.payload.address;throw(0,N.convertDeviceError)(u.payload)}));return function(t){return e.apply(this,arguments)}}(),n.batchGetAddress=function(){var e=(0,a.default)((function*(e){var t=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),n=r.connectId,o=r.deviceId,i=yield this.getWalletPassphraseState();try{var a=yield t.dnxGetAddress(n,o,z({bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey}}))},i));if(!a.success)throw h.default.common.error(a.payload),(0,N.convertDeviceError)(a.payload);return a.payload.map((function(e){var t,r;return{path:null!=(t=e.path)?t:"",address:null!=(r=e.address)?r:""}}))}catch(u){throw h.default.common.error(u),new w.OneKeyHardwareError(u)}}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=(0,a.default)((function*(e){h.default.common.info("signTransaction",e);var t=e.payload.encodedTx,r=yield this.getDbAccount(),n=yield this.getNetwork(),o={path:r.path,inputs:t.inputs,toAddress:t.to,amount:new(f())(t.amount).shiftedBy(n.decimals).toFixed(),fee:new(f())(t.fee).shiftedBy(n.feeDecimals).toFixed(),paymentIdHex:t.paymentId},i=yield this.getHardwareInfo(),a=i.connectId,u=i.deviceId,s=yield this.getWalletPassphraseState(),c=yield this.getHardwareSDKInstance(),d=yield c.dnxSignTransaction(a,u,z(z({},s),o));if(d.success){console.log("signTransaction response",d.payload);var l=function(e){var t=e.signTxParams,r=e.encodedTx,n=e.payload,o="",i=n.txKey,a=n.computedKeyImages,u=n.signatures,s=n.outputKeys,c=W(r.from),d=W(r.to),l=t.inputs.reduce((function(e,t){return e.plus(t.amount)}),new(f())(0)).minus(t.amount).minus(t.fee);o+="01",o+="00",o+=L(t.inputs.length);for(var p=0;p<t.inputs.length;p+=1){var h=t.inputs[p];o+="02",o+=L(h.amount),o+=L(1),o+=L(h.globalIndex),o+=a[p]}o+=L(s.length);for(var y=0;y<s.length;y+=1){var v=s[y];o+=L(y===s.length-1&&l.gt(0)?l.toNumber():Number(t.amount)),o+="02",o+=v}var w="";for(var g of(t.paymentIdHex&&(w+="02",w+="21",w+="00",w+=t.paymentIdHex),w+="01",w+=i.ephemeralTxPubKey,w+="04",w+=c.spend,w+=c.view,w+="05",w+=d.spend,w+=d.view,w+="06",w+=function(e){var t,r=e.number,n=e.bytes,o=r.toString(16);for(o.length%2!==0&&(o=`0${o}`);o.length/2<n;)o=`00${o}`;return(null!=(t=o.match(/.{2}/g))?t:[]).reverse().join("")}({number:Number(t.amount),bytes:8}),w+="07",o+=L((w+=i.ephemeralTxSecKey).length/2),o+=w,u))o+=g;return o}({encodedTx:t,signTxParams:o,payload:d.payload});return{txid:(0,F.stripHexPrefix)(G(l)),rawTx:l}}if(d.payload.code===B.HardwareErrorCode.RuntimeError&&-1!==d.payload.error.indexOf("Invalid number of inputs"))throw new Error("Exceeded UTXO inputs limit.");throw(0,N.convertDeviceError)(d.payload)}));return function(t){return e.apply(this,arguments)}}(),n.signMessage=function(){throw new Error("Method not implemented.")},(0,u.default)(r)}(H.KeyringHardwareBase);function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var Z=function(e){(0,s.default)(r,e);var t=J(r);function r(){return t.apply(this,arguments)}return(0,u.default)(r)}(r(810887).KeyringHdBase);function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var ee=function(e){(0,s.default)(r,e);var t=Q(r);function r(){return t.apply(this,arguments)}return(0,u.default)(r)}(r(255942).KeyringImportedBase);function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var re=function(e){(0,s.default)(r,e);var t=te(r);function r(){return t.apply(this,arguments)}return(0,u.default)(r)}(r(701625).KeyringWatchingBase),ne=r(20135);function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var ae=1e6,ue=function(e){(0,s.default)(r,e);var t=ie(r);function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).keyringMap={hd:Z,hw:Y,imported:ee,watching:re,external:re},e.settings=ne.default,e.createClientFromURL=(0,y.memoizee)((function(e){return new _(e)}),{max:1,maxAge:(0,p.getTimeDurationMs)({minute:3})}),e._validateAddressMemo=(0,y.memoizee)(function(){var t=(0,a.default)((function*(t){var r=yield e.getClient();if(!(yield r.validateAddress(t)))throw new w.InvalidAddress;return Promise.resolve(t)}));return function(e){return t.apply(this,arguments)}}(),{max:5,maxAge:(0,p.getTimeDurationMs)({minute:3})}),e}var n=r.prototype;return n.getClient=function(){var e=(0,a.default)((function*(e){var t=yield this.getRpcUrl();return this.createClientFromURL(null!=e?e:t)}));return function(t){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=(0,a.default)((function*(e){var t=yield this.getClient(e),r=performance.now(),n=yield t.getBlockCount();return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=(0,a.default)((function*(e){for(var t=yield this.getClient(),r=[],n=0;n<e.length;n+=1){var o=yield t.getBalanceOfAddress(e[n].address);r.push(o)}return r}));return function(t){return e.apply(this,arguments)}}(),n.updateEncodedTxTokenApprove=function(e,t){throw new Error("Method not implemented.")},n.buildUnsignedTxFromEncodedTx=function(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})},n.fetchFeeInfo=function(){var e=(0,a.default)((function*(){var e=yield this.getNetwork(),t=[new(f())(1e6).shiftedBy(-e.feeDecimals).toFixed()];return{nativeSymbol:e.symbol,nativeDecimals:e.decimals,feeSymbol:e.feeSymbol,feeDecimals:e.feeDecimals,limit:"1",prices:t,defaultPresetIndex:"0",tx:null}}));return function(){return e.apply(this,arguments)}}(),n.getExportedCredential=function(){var e=(0,a.default)((function*(){throw new Error("Method not implemented.")}));return function(){return e.apply(this,arguments)}}(),n.fetchTokenInfos=function(e){throw new Error("Method not implemented.")},n.updateEncodedTx=function(e){return Promise.resolve(e)},n.decodeTx=function(){var e=(0,a.default)((function*(e,t){var r=yield this.engine.getNetwork(this.networkId),n=yield this.getAccountAddress(),o=yield this.engine.getNativeTokenInfo(this.networkId),i=[];return i.push({type:g.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:o,from:e.from,to:e.to,amount:e.amount,amountValue:new(f())(e.amount).shiftedBy(r.decimals).toFixed(),extraInfo:null,utxoFrom:[],utxoTo:[]},direction:e.to===n?g.IDecodedTxDirection.SELF:g.IDecodedTxDirection.OUT}),{txid:"",owner:n,signer:e.from||n,nonce:0,actions:i,status:g.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:e,payload:t,extraInfo:null}}));return function(t,r){return e.apply(this,arguments)}}(),n.decodedTxToLegacy=function(e){return Promise.resolve({})},n.buildEncodedTxFromApprove=function(e){throw new w.NotImplemented},n.attachFeeInfoToEncodedTx=function(e){var t=e.encodedTx;return Promise.resolve(t)},n.buildEncodedTxFromTransfer=function(){var e=(0,a.default)((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var t=yield this.getNetwork(),r=yield this._collectUnspentOutputs(),n=this._collectInputs({unspentOutputs:Object.values(r),amount:new(f())(e.amount).shiftedBy(t.decimals).toFixed(),fee:new(f())(ae).toFixed()}),o=n.inputs,i=n.finalAmount;return{from:e.from,to:e.to,amount:new(f())(i).shiftedBy(-t.decimals).toFixed(),paymentId:e.paymentId,fee:new(f())(ae).shiftedBy(-t.feeDecimals).toFixed(),inputs:o}}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=(0,a.default)((function*(e){return this._validateAddressMemo(e)}));return function(t){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=(0,a.default)((function*(e,t){h.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.getClient(),n=yield r.broadcastTransaction(e.rawTx);return h.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),e}));return function(t,r){return e.apply(this,arguments)}}(),n.fetchOnChainHistory=function(){var e=(0,a.default)((function*(e){var t=this,r=yield this.getClient(),n=e.localHistory,o=yield this.getAccountAddress(),i=yield this.engine.getNativeTokenInfo(this.networkId),u=yield this.getNetwork(),s=(yield r.getTransactionsByAddress(o)).map(function(){var e=(0,a.default)((function*(e){try{var r,a,s=n.find((function(t){return t.decodedTx.txid===e.hash}));if(s&&s.decodedTx.isFinal)return null;var c=g.IDecodedTxDirection.OUT;e.to_address.includes(o)&&(c=e.from_address===o?g.IDecodedTxDirection.SELF:g.IDecodedTxDirection.IN);var d=e.amount[0],l={txid:null!=(r=e.hash)?r:"",owner:o,signer:e.from_address,nonce:0,actions:[{type:g.IDecodedTxActionType.NATIVE_TRANSFER,direction:c,nativeTransfer:{tokenInfo:i,from:e.from_address,to:e.to_address[0],amount:new(f())(d).shiftedBy(-u.decimals).toFixed(),amountValue:d,extraInfo:null}}],status:g.IDecodedTxStatus.Confirmed,totalFeeInNative:new(f())(e.fee).shiftedBy(-u.feeDecimals).toFixed(),networkId:t.networkId,accountId:t.accountId,extraInfo:null};return l.updatedAt=new Date(1e3*e.timestamp).getTime(),l.createdAt=null!=(a=null==s?void 0:s.decodedTx.createdAt)?a:l.updatedAt,l.isFinal=l.status===g.IDecodedTxStatus.Confirmed,yield t.buildHistoryTx({decodedTx:l,historyTxToMerge:s})}catch(p){return console.error(p),Promise.resolve(null)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(s)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(){var e=(0,a.default)((function*(e){var t=yield this.getClient();return Promise.all(e.map(function(){var e=(0,a.default)((function*(e){return t.getTransactionStatus(e)}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=(0,a.default)((function*(){try{for(var e,t=0,r=!1,n=(yield v.default.history.getAccountHistory({accountId:this.accountId,networkId:this.networkId,isPending:!0,limit:10})).items,o=0,i=n.length;o<i;o=1){var a=n[o].decodedTx.actions[0];if(a.type===g.IDecodedTxActionType.NATIVE_TRANSFER&&(g.IDecodedTxDirection.OUT===a.direction||g.IDecodedTxDirection.SELF===a.direction)){r=!0;break}}return r&&(t=-1),null!=(e=t)?e:0}catch(u){return console.error(u),0}}));return function(){return e.apply(this,arguments)}}(),n._collectInputs=function(e){var t,r=e.unspentOutputs,n=e.amount,o=e.fee,a=new(f())(n),u=r.reduce((function(e,t){return e.plus(t.amount)}),new(f())(0));if(u.lte(o))throw new w.InsufficientBalance;u.lt(new(f())(a).plus(o))&&(a=u.minus(o));var s=r.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({txId:"",vout:0,value:e.amount,address:"",path:""},e)})),c=[{address:"",value:a.plus(o).toNumber()}],d=(0,m.coinSelect)({inputsForCoinSelect:s,outputsForCoinSelect:c,feeRate:"0"}).inputs;return{finalAmount:a.toFixed(),inputs:null!=(t=null==d?void 0:d.map((function(e){var t=e;return{globalIndex:t.globalIndex,prevIndex:t.prevIndex,prevOutPubkey:t.prevOutPubkey,txPubkey:t.txPubkey,amount:t.amount}})))?t:[]}},n._collectUnspentOutputs=function(){var e=(0,a.default)((function*(){for(var e=yield this.getClient(),t=yield this.getAccountAddress(),r=yield e.getTransactionsByAddress(t),n={},o=function*(){var o,a=r[i],u=yield e.getTransaction(a.hash);u.address_from===t&&u.inputs.forEach((function(e){var t=n[`${e.data.input.key_offsets[0]}_${e.data.input.amount}`];t&&t.amount===e.data.input.amount&&delete n[`${e.data.input.key_offsets[0]}_${e.data.input.amount}`]})),null==(o=u.outputs)||o.forEach((function(e,r){e.address_to===t&&(n[`${e.globalIndex}_${e.output.amount}`]={prevIndex:r,globalIndex:e.globalIndex,txPubkey:u.extra.publicKey,prevOutPubkey:e.output.target.data.key,amount:e.output.amount})}))},i=0;i<r.length;i+=1)yield*o();return n}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r)}(x.VaultBase)},565147:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringBase:()=>c,KeyringBaseMock:()=>d});var n=r(634795),o=r(887371),i=r(545754),a=r(411987),u=r(695058);function s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var c=function(e){(0,i.default)(r,e);var t=s(r);function r(e){var r;return(r=t.call(this,e.options)).vault=e,r}return r.prototype.addressFromBase=function(){var e=(0,n.default)((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),(0,o.default)(r)}(r(114540).VaultContext),d=function(e){(0,i.default)(r,e);var t=s(r);function r(){return t.apply(this,arguments)}return(0,o.default)(r)}(c)},82406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringHardwareBase:()=>l});var n=r(634795),o=r(887371),i=r(545754),a=r(411987),u=r(695058),s=r(799075),c=r(814817);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var l=function(e){(0,i.default)(a,e);var t=d(a);function a(){return t.apply(this,arguments)}var u=a.prototype;return u.getHardwareInfo=function(){var e=(0,n.default)((function*(){var e,t,r,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:"",deviceType:null!=(r=null==n?void 0:n.deviceType)?r:""}}));return function(){return e.apply(this,arguments)}}(),u.getWalletPassphraseState=function(){var e=(0,n.default)((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!(0,c.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),u.getHardwareSDKInstance=function(){var e=(0,n.default)((function*(){var e,t,n,o,i;return null!=(i=yield null==(e=r.g)||null==(t=e.$backgroundApiProxy)||null==(n=t.backgroundApi)||null==(o=n.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:s.HardwareSDK}));return function(){return e.apply(this,arguments)}}(),u.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,o.default)(a)}(r(565147).KeyringBase)},810887:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringHdBase:()=>h});var n=r(256666),o=r(634795),i=r(887371),a=r(545754),u=r(411987),s=r(695058),c=r(605851),d=r(940915);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var h=function(e){(0,a.default)(r,e);var t=p(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=(0,o.default)((function*(e,t){var r=(yield this.getDbAccount()).path.split("/"),n=t||[r.pop()],o=r.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new d.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return(0,c.batchGetPrivateKeys)(a,i,e,o,n).reduce((function(e,t){var r;return f(f({},e),{},((r={})[t.path]=t.extendedKey.key,r))}),{})}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,i.default)(r)}(r(280306).KeyringSoftwareBase)},255942:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringImportedBase:()=>d});var n=r(634795),o=r(887371),i=r(545754),a=r(411987),u=r(695058),s=r(940915);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return t.apply(this,arguments)}var a=r.prototype;return a.getPrivateKeys=function(){var e=(0,n.default)((function*(e,t){if("undefined"!==typeof t)throw new s.NotImplemented("Getting private keys from extended private key");var r=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof r)throw new s.OneKeyInternalError("Unable to get credential.");return{"":r}}));return function(t,r){return e.apply(this,arguments)}}(),a.getAddress=function(){throw new Error("Method not implemented.")},a.batchGetAddress=function(){throw new Error("Method not implemented.")},a.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,o.default)(r)}(r(280306).KeyringSoftwareBase)},280306:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringSoftwareBase:()=>y});var n=r(196234),o=r(256666),i=r(634795),a=r(887371),u=r(545754),s=r(411987),c=r(695058),d=r(292147),l=r(940915);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var o=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var y=function(e){(0,u.default)(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=(0,i.default)((function*(e,t){var r=t.password;if("undefined"===typeof r)throw new l.OneKeyInternalError("Software signing requires a password.");var n=yield this.getSigners(r,e.inputs.map((function(e){return e.address})));return d.default.engine.info("signTransaction",this.networkId,e),p(p({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),o.signMessage=function(){var e=(0,i.default)((function*(e,t){var r=this,o=t.password;if("undefined"===typeof o)throw new l.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(o,[i.address])),u=(0,n.default)(a,1)[0];return d.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return r.engine.providerManager.signMessage(r.networkId,e,u)})))}));return function(t,r){return e.apply(this,arguments)}}(),o.getAddress=function(){throw new Error("Method not implemented.")},o.batchGetAddress=function(){throw new Error("Method not implemented.")},o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,a.default)(r)}(r(565147).KeyringBase)},701625:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyringWatchingBase:()=>d});var n=r(634795),o=r(887371),i=r(545754),a=r(411987),u=r(695058),s=r(940915);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return t.apply(this,arguments)}var a=r.prototype;return a.signTransaction=function(){var e=(0,n.default)((function*(e,t){throw new s.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),a.signMessage=function(){var e=(0,n.default)((function*(e,t){throw new s.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),a.getAddress=function(){throw new Error("Method not implemented.")},a.batchGetAddress=function(){throw new Error("Method not implemented.")},a.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,o.default)(r)}(r(565147).KeyringBase)},153546:(e,t,r)=>{"use strict";r.r(t),r.d(t,{convertDeviceError:()=>u});var n=r(703599),o=r(302478),i=r(292147);r(213208);function a(e,t){return"string"!==typeof t?null:e===n.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new o.BridgeNetworkError({message:t}):null}function u(e){var t,r=e||{},u=r.code,s=r.error,c=r.message,d=null!=(t=null!=s?s:c)?t:"Unknown error";if(a(u,d))return a(u,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",u,d),u){case n.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case n.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case n.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case n.HardwareErrorCode.DeviceInterruptedFromOutside:case n.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case n.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case n.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case n.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case n.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case n.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case n.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case n.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case n.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case n.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case n.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case n.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case n.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case n.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case n.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case n.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case n.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case n.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case n.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case n.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case n.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case n.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case n.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case n.HardwareErrorCode.PinCancelled:case n.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case n.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case n.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case n.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case n.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case n.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case n.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case n.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case n.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case n.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);case n.HardwareErrorCode.DataOverload:return new o.DeviceDataOverload(e);default:return new o.UnknownHardwareError(e)}}},243868:(e,t)=>{!function(e){"use strict";var t={};function r(e,n,i){if(i!==t)return e instanceof r?e:"undefined"===typeof e?o:r.parse(e);for(e=e||[];e.length&&!e[e.length-1];)--e.length;this._d=e,this._s=e.length?n||1:0}r._construct=function(e,n){return new r(e,n,t)};var n=1e7;r.base=n,r.base_log10=7;var o=new r([],0,t);r.ZERO=o;var i=new r([1],1,t);r.ONE=i;var a=new r(i._d,-1,t);r.M_ONE=a,r._0=o,r._1=i,r.small=[o,i,new r([2],1,t),new r([3],1,t),new r([4],1,t),new r([5],1,t),new r([6],1,t),new r([7],1,t),new r([8],1,t),new r([9],1,t),new r([10],1,t),new r([11],1,t),new r([12],1,t),new r([13],1,t),new r([14],1,t),new r([15],1,t),new r([16],1,t),new r([17],1,t),new r([18],1,t),new r([19],1,t),new r([20],1,t),new r([21],1,t),new r([22],1,t),new r([23],1,t),new r([24],1,t),new r([25],1,t),new r([26],1,t),new r([27],1,t),new r([28],1,t),new r([29],1,t),new r([30],1,t),new r([31],1,t),new r([32],1,t),new r([33],1,t),new r([34],1,t),new r([35],1,t),new r([36],1,t)],r.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r.prototype.toString=function(e){if((e=+e||10)<2||e>36)throw new Error("illegal radix "+e+".");if(0===this._s)return"0";if(10===e){var t=this._s<0?"-":"";t+=this._d[this._d.length-1].toString();for(var n=this._d.length-2;n>=0;n--){for(var o=this._d[n].toString();o.length<7;)o="0"+o;t+=o}return t}var i=r.digits;e=r.small[e];for(var a,u=this._s,s=this.abs(),c=[];0!==s._s;){var d=s.divRem(e);s=d[0],a=d[1],c.push(i[a.valueOf()])}return(u<0?"-":"")+c.reverse().join("")},r.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/],r.parse=function(e,n){var i;e=e.toString(),"undefined"!==typeof n&&10!==+n||(e=e.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e").replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,(function(e,t,r,n,o){var i=(o=+o)<0,a=r.length+o;e=(i?r:n).length,o=(o=Math.abs(o))>=e?o-e+i:0;var u=new Array(o+1).join("0"),s=r+n;return(t||"")+(i?s=u+s:s+=u).substr(0,a+=i?u.length:0)+(a<s.length?"."+s.substr(a):"")}))),i="undefined"===typeof n?"0[xcb]":16==n?"0x":8==n?"0c":2==n?"0b":"";var a=new RegExp("^([+\\-]?)("+i+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(e);if(a){var u=a[1]||"+",s=a[2]||"",c=a[3]||"";if("undefined"===typeof n)n="0x"===s||"0X"===s?16:"0c"===s||"0C"===s?8:"0b"===s||"0B"===s?2:10;else if(n<2||n>36)throw new Error("Illegal radix "+n+".");if(n=+n,!r.radixRegex[n].test(c))throw new Error("Bad digit for radix "+n);if(0===(c=c.replace(/^0+/,"").split("")).length)return o;if(u="-"===u?-1:1,10==n){for(var d=[];c.length>=7;)d.push(parseInt(c.splice(c.length-r.base_log10,r.base_log10).join(""),10));return d.push(parseInt(c.join(""),10)),new r(d,u,t)}d=o;n=r.small[n];for(var l=r.small,f=0;f<c.length;f++)d=d.multiply(n).add(l[parseInt(c[f],36)]);return new r(d._d,u,t)}throw new Error("Invalid BigInteger format: "+e)},r.prototype.add=function(e){if(0===this._s)return r(e);if(0===(e=r(e))._s)return this;if(this._s!==e._s)return e=e.negate(),this.subtract(e);for(var o,i=this._d,a=e._d,u=i.length,s=a.length,c=new Array(Math.max(u,s)+1),d=Math.min(u,s),l=0,f=0;f<d;f++)o=i[f]+a[f]+l,c[f]=o%n,l=o/n|0;for(s>u&&(i=a,u=s),f=d;l&&f<u;f++)o=i[f]+l,c[f]=o%n,l=o/n|0;for(l&&(c[f]=l);f<u;f++)c[f]=i[f];return new r(c,this._s,t)},r.prototype.negate=function(){return new r(this._d,0|-this._s,t)},r.prototype.abs=function(){return this._s<0?this.negate():this},r.prototype.subtract=function(e){if(0===this._s)return r(e).negate();if(0===(e=r(e))._s)return this;if(this._s!==e._s)return e=e.negate(),this.add(e);var i=this;this._s<0&&(i=new r(e._d,1,t),e=new r(this._d,1,t));var a=i.compareAbs(e);if(0===a)return o;if(a<0){var u=e;e=i,i=u}var s,c,d=i._d,l=e._d,f=d.length,p=l.length,h=new Array(f),y=0;for(s=0;s<p;s++)(c=d[s]-y-l[s])<0?(c+=n,y=1):y=0,h[s]=c;for(s=p;s<f;s++){if(!((c=d[s]-y)<0)){h[s++]=c;break}c+=n,h[s]=c}for(;s<f;s++)h[s]=d[s];return new r(h,a,t)},function(){function e(e,o){for(var i=e._d,a=i.slice(),u=0;;){var s=(i[u]||0)+1;if(a[u]=s%n,s<=9999999)break;++u}return new r(a,o,t)}function o(e,o){for(var i=e._d,a=i.slice(),u=0;;){var s=(i[u]||0)-1;if(!(s<0)){a[u]=s;break}a[u]=s+n,++u}return new r(a,o,t)}r.prototype.next=function(){switch(this._s){case 0:return i;case-1:return o(this,-1);default:return e(this,1)}},r.prototype.prev=function(){switch(this._s){case 0:return a;case-1:return e(this,-1);default:return o(this,1)}}}(),r.prototype.compareAbs=function(e){if(this===e)return 0;if(!(e instanceof r)){if(!isFinite(e))return isNaN(e)?e:-1;e=r(e)}if(0===this._s)return 0!==e._s?-1:0;if(0===e._s)return 1;var t=this._d.length,n=e._d.length;if(t<n)return-1;if(t>n)return 1;for(var o=this._d,i=e._d,a=t-1;a>=0;a--)if(o[a]!==i[a])return o[a]<i[a]?-1:1;return 0},r.prototype.compare=function(e){return this===e?0:(e=r(e),0===this._s?-e._s:this._s===e._s?this.compareAbs(e)*this._s:this._s)},r.prototype.isUnit=function(){return this===i||this===a||1===this._d.length&&1===this._d[0]},r.prototype.multiply=function(e){if(0===this._s)return o;if(0===(e=r(e))._s)return o;if(this.isUnit())return this._s<0?e.negate():e;if(e.isUnit())return e._s<0?this.negate():this;if(this===e)return this.square();var i,a=this._d.length>=e._d.length,u=(a?this:e)._d,s=(a?e:this)._d,c=u.length,d=s.length,l=c+d,f=new Array(l);for(i=0;i<l;i++)f[i]=0;for(i=0;i<d;i++){for(var p,h=0,y=s[i],v=c+i,w=i;w<v;w++)h=(p=f[w]+y*u[w-i]+h)/n|0,f[w]=p%n|0;h&&(h=(p=f[w]+h)/n|0,f[w]=p%n)}return new r(f,this._s*e._s,t)},r.prototype.multiplySingleDigit=function(e){if(0===e||0===this._s)return o;if(1===e)return this;var i;if(1===this._d.length)return new r((i=this._d[0]*e)>=n?[i%n|0,i/n|0]:[i],1,t);if(2===e)return this.add(this);if(this.isUnit())return new r([e],1,t);for(var a=this._d,u=a.length,s=u+1,c=new Array(s),d=0;d<s;d++)c[d]=0;for(var l=0,f=0;f<u;f++)l=(i=e*a[f]+l)/n|0,c[f]=i%n|0;return l&&(c[f]=l),new r(c,1,t)},r.prototype.square=function(){if(0===this._s)return o;if(this.isUnit())return i;var e,a,u,s,c=this._d,d=c.length,l=new Array(d+d+1);for(s=0;s<d;s++)u=2*s,a=(e=c[s]*c[s])/n|0,l[u]=e%n,l[u+1]=a;for(s=0;s<d;s++){a=0,u=2*s+1;for(var f=s+1;f<d;f++,u++)a=(e=c[f]*c[s]*2+l[u]+a)/n|0,l[u]=e%n;var p=a+l[u=d+s];a=p/n|0,l[u]=p%n,l[u+1]+=a}return new r(l,1,t)},r.prototype.quotient=function(e){return this.divRem(e)[0]},r.prototype.divide=r.prototype.quotient,r.prototype.remainder=function(e){return this.divRem(e)[1]},r.prototype.divRem=function(e){if(0===(e=r(e))._s)throw new Error("Divide by zero");if(0===this._s)return[o,o];if(1===e._d.length)return this.divRemSmall(e._s*e._d[0]);switch(this.compareAbs(e)){case 0:return[this._s===e._s?i:a,o];case-1:return[o,this]}var u,s=this._s*e._s,c=e.abs(),d=this._d,l=d.length,f=(e._d.length,[]),p=new r([],0,t);for(p._s=1;l;)if(p._d.unshift(d[--l]),p.compareAbs(e)<0)f.push(0);else{if(0===p._s)u=0;else{var h=p._d.length,y=c._d.length,v=p._d[h-1]*n+p._d[h-2],w=c._d[y-1]*n+c._d[y-2];p._d.length>c._d.length&&(v=(v+1)*n),u=Math.ceil(v/w)}do{var g=c.multiplySingleDigit(u);if(g.compareAbs(p)<=0)break;u--}while(u);if(f.push(u),u){var m=p.subtract(g);p._d=m._d.slice(),0===p._d.length&&(p._s=0)}}return[new r(f.reverse(),s,t),new r(p._d,this._s,t)]},r.prototype.divRemSmall=function(e){var i;if(0===(e=+e))throw new Error("Divide by zero");var a=e<0?-1:1,u=this._s*a;if((e=Math.abs(e))<1||e>=n)throw new Error("Argument out of range");if(0===this._s)return[o,o];if(1===e||-1===e)return[1===u?this.abs():new r(this._d,u,t),o];if(1===this._d.length){var s=new r([this._d[0]/e|0],1,t);return i=new r([this._d[0]%e|0],1,t),u<0&&(s=s.negate()),this._s<0&&(i=i.negate()),[s,i]}for(var c,d=this._d.slice(),l=new Array(d.length),f=0,p=0,h=0;d.length;){if((f=f*n+d[d.length-1])<e)l[h++]=0,d.pop(),p=n*p+f;else p=f-e*(c=0===f?0:f/e|0),l[h++]=c,c?(d.pop(),f=p):d.pop()}return i=new r([p],1,t),this._s<0&&(i=i.negate()),[new r(l.reverse(),u,t),i]},r.prototype.isEven=function(){var e=this._d;return 0===this._s||0===e.length||e[0]%2===0},r.prototype.isOdd=function(){return!this.isEven()},r.prototype.sign=function(){return this._s},r.prototype.isPositive=function(){return this._s>0},r.prototype.isNegative=function(){return this._s<0},r.prototype.isZero=function(){return 0===this._s},r.prototype.exp10=function(e){if(0===(e=+e))return this;if(Math.abs(e)>Number(u))throw new Error("exponent too large in BigInteger.exp10");if(e>0){for(var n=new r(this._d.slice(),this._s,t);e>=7;e-=7)n._d.unshift(0);return 0==e?n:(n._s=1,n=n.multiplySingleDigit(Math.pow(10,e)),this._s<0?n.negate():n)}if(-e>=7*this._d.length)return o;n=new r(this._d.slice(),this._s,t);for(e=-e;e>=7;e-=7)n._d.shift();return 0==e?n:n.divRemSmall(Math.pow(10,e))[0]},r.prototype.pow=function(e){if(this.isUnit())return this._s>0||r(e).isOdd()?this:this.negate();if(0===(e=r(e))._s)return i;if(e._s<0){if(0===this._s)throw new Error("Divide by zero");return o}if(0===this._s)return o;if(e.isUnit())return this;if(e.compareAbs(u)>0)throw new Error("exponent too large in BigInteger.pow");for(var t=this,n=i,a=r.small[2];e.isPositive();){if(e.isOdd()&&(n=n.multiply(t),e.isUnit()))return n;t=t.square(),e=e.quotient(a)}return n},r.prototype.modPow=function(e,t){for(var n=i,o=this;e.isPositive();)e.isOdd()&&(n=n.multiply(o).remainder(t)),(e=e.quotient(r.small[2])).isPositive()&&(o=o.square().remainder(t));return n},r.prototype.log=function(){switch(this._s){case 0:return-1/0;case-1:return NaN}var e=this._d.length;if(7*e<30)return Math.log(this.valueOf());var o=Math.ceil(30/7),i=this._d.slice(e-o);return Math.log(new r(i,1,t).valueOf())+(e-o)*Math.log(n)},r.prototype.valueOf=function(){return parseInt(this.toString(),10)},r.prototype.toJSValue=function(){return parseInt(this.toString(),10)},r.prototype.lowVal=function(){return this._d[0]||0};var u=r(2147483647);r.MAX_EXP=u,function(){function e(e){return function(t){return e.call(r(t))}}function t(e){return function(t,n){return e.call(r(t),r(n))}}function n(e){return function(t,n,o){return e.call(r(t),r(n),r(o))}}!function(){var o,i,a="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev,log".split(","),u="compare,remainder,divRem,subtract,add,quotient,divide,multiply,pow,compareAbs".split(","),s=["modPow"];for(o=0;o<a.length;o++)r[i=a[o]]=e(r.prototype[i]);for(o=0;o<u.length;o++)r[i=u[o]]=t(r.prototype[i]);for(o=0;o<s.length;o++)r[i=s[o]]=n(r.prototype[i]);r.exp10=function(e,t){return r(e).exp10(t)}}()}(),e.BigInteger=r}(t)}}]);